<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Errors.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">v3io-kafka-client</a> &gt; <a href="index.source.html" class="el_package">org.apache.kafka.common.protocol</a> &gt; <span class="el_source">Errors.java</span></div><h1>Errors.java</h1><pre class="source lang-java linenums">/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.kafka.common.protocol;

import java.util.HashMap;
import java.util.Map;

import org.apache.kafka.common.errors.ApiException;
import org.apache.kafka.common.errors.BrokerNotAvailableException;
import org.apache.kafka.common.errors.ClusterAuthorizationException;
import org.apache.kafka.common.errors.ControllerMovedException;
import org.apache.kafka.common.errors.CorruptRecordException;
import org.apache.kafka.common.errors.GroupAuthorizationException;
import org.apache.kafka.common.errors.GroupCoordinatorNotAvailableException;
import org.apache.kafka.common.errors.GroupLoadInProgressException;
import org.apache.kafka.common.errors.IllegalGenerationException;
import org.apache.kafka.common.errors.IllegalSaslStateException;
import org.apache.kafka.common.errors.InconsistentGroupProtocolException;
import org.apache.kafka.common.errors.InvalidCommitOffsetSizeException;
import org.apache.kafka.common.errors.InvalidConfigurationException;
import org.apache.kafka.common.errors.InvalidFetchSizeException;
import org.apache.kafka.common.errors.InvalidGroupIdException;
import org.apache.kafka.common.errors.InvalidPartitionsException;
import org.apache.kafka.common.errors.InvalidReplicaAssignmentException;
import org.apache.kafka.common.errors.InvalidReplicationFactorException;
import org.apache.kafka.common.errors.InvalidRequestException;
import org.apache.kafka.common.errors.InvalidRequiredAcksException;
import org.apache.kafka.common.errors.InvalidSessionTimeoutException;
import org.apache.kafka.common.errors.InvalidTimestampException;
import org.apache.kafka.common.errors.InvalidTopicException;
import org.apache.kafka.common.errors.LeaderNotAvailableException;
import org.apache.kafka.common.errors.NetworkException;
import org.apache.kafka.common.errors.NotControllerException;
import org.apache.kafka.common.errors.NotCoordinatorForGroupException;
import org.apache.kafka.common.errors.NotEnoughReplicasAfterAppendException;
import org.apache.kafka.common.errors.NotEnoughReplicasException;
import org.apache.kafka.common.errors.NotLeaderForPartitionException;
import org.apache.kafka.common.errors.OffsetMetadataTooLarge;
import org.apache.kafka.common.errors.OffsetOutOfRangeException;
import org.apache.kafka.common.errors.RebalanceInProgressException;
import org.apache.kafka.common.errors.RecordBatchTooLargeException;
import org.apache.kafka.common.errors.RecordTooLargeException;
import org.apache.kafka.common.errors.ReplicaNotAvailableException;
import org.apache.kafka.common.errors.RetriableException;
import org.apache.kafka.common.errors.TopicExistsException;
import org.apache.kafka.common.errors.UnsupportedSaslMechanismException;
import org.apache.kafka.common.errors.TimeoutException;
import org.apache.kafka.common.errors.TopicAuthorizationException;
import org.apache.kafka.common.errors.UnsupportedVersionException;
import org.apache.kafka.common.errors.UnknownMemberIdException;
import org.apache.kafka.common.errors.UnknownServerException;
import org.apache.kafka.common.errors.UnknownTopicOrPartitionException;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * This class contains all the client-server errors--those errors that must be sent from the server to the client. These
 * are thus part of the protocol. The names can be changed but the error code cannot.
 *
 * Do not add exceptions that occur only on the client or only on the server here.
 */
<span class="nc" id="L76">public enum Errors {</span>
<span class="nc" id="L77">    UNKNOWN(-1, new UnknownServerException(&quot;The server experienced an unexpected error when processing the request&quot;)),</span>
<span class="nc" id="L78">    NONE(0, null),</span>
<span class="nc" id="L79">    OFFSET_OUT_OF_RANGE(1,</span>
            new OffsetOutOfRangeException(&quot;The requested offset is not within the range of offsets maintained by the server.&quot;)),
<span class="nc" id="L81">    CORRUPT_MESSAGE(2,</span>
            new CorruptRecordException(&quot;This message has failed its CRC checksum, exceeds the valid size, or is otherwise corrupt.&quot;)),
<span class="nc" id="L83">    UNKNOWN_TOPIC_OR_PARTITION(3,</span>
            new UnknownTopicOrPartitionException(&quot;This server does not host this topic-partition.&quot;)),
<span class="nc" id="L85">    INVALID_FETCH_SIZE(4,</span>
            new InvalidFetchSizeException(&quot;The requested fetch size is invalid.&quot;)),
<span class="nc" id="L87">    LEADER_NOT_AVAILABLE(5,</span>
            new LeaderNotAvailableException(&quot;There is no leader for this topic-partition as we are in the middle of a leadership election.&quot;)),
<span class="nc" id="L89">    NOT_LEADER_FOR_PARTITION(6,</span>
            new NotLeaderForPartitionException(&quot;This server is not the leader for that topic-partition.&quot;)),
<span class="nc" id="L91">    REQUEST_TIMED_OUT(7,</span>
            new TimeoutException(&quot;The request timed out.&quot;)),
<span class="nc" id="L93">    BROKER_NOT_AVAILABLE(8,</span>
            new BrokerNotAvailableException(&quot;The broker is not available.&quot;)),
<span class="nc" id="L95">    REPLICA_NOT_AVAILABLE(9,</span>
            new ReplicaNotAvailableException(&quot;The replica is not available for the requested topic-partition&quot;)),
<span class="nc" id="L97">    MESSAGE_TOO_LARGE(10,</span>
            new RecordTooLargeException(&quot;The request included a message larger than the max message size the server will accept.&quot;)),
<span class="nc" id="L99">    STALE_CONTROLLER_EPOCH(11,</span>
            new ControllerMovedException(&quot;The controller moved to another broker.&quot;)),
<span class="nc" id="L101">    OFFSET_METADATA_TOO_LARGE(12,</span>
            new OffsetMetadataTooLarge(&quot;The metadata field of the offset request was too large.&quot;)),
<span class="nc" id="L103">    NETWORK_EXCEPTION(13,</span>
            new NetworkException(&quot;The server disconnected before a response was received.&quot;)),
<span class="nc" id="L105">    GROUP_LOAD_IN_PROGRESS(14,</span>
            new GroupLoadInProgressException(&quot;The coordinator is loading and hence can't process requests for this group.&quot;)),
<span class="nc" id="L107">    GROUP_COORDINATOR_NOT_AVAILABLE(15,</span>
            new GroupCoordinatorNotAvailableException(&quot;The group coordinator is not available.&quot;)),
<span class="nc" id="L109">    NOT_COORDINATOR_FOR_GROUP(16,</span>
            new NotCoordinatorForGroupException(&quot;This is not the correct coordinator for this group.&quot;)),
<span class="nc" id="L111">    INVALID_TOPIC_EXCEPTION(17,</span>
            new InvalidTopicException(&quot;The request attempted to perform an operation on an invalid topic.&quot;)),
<span class="nc" id="L113">    RECORD_LIST_TOO_LARGE(18,</span>
            new RecordBatchTooLargeException(&quot;The request included message batch larger than the configured segment size on the server.&quot;)),
<span class="nc" id="L115">    NOT_ENOUGH_REPLICAS(19,</span>
            new NotEnoughReplicasException(&quot;Messages are rejected since there are fewer in-sync replicas than required.&quot;)),
<span class="nc" id="L117">    NOT_ENOUGH_REPLICAS_AFTER_APPEND(20,</span>
            new NotEnoughReplicasAfterAppendException(&quot;Messages are written to the log, but to fewer in-sync replicas than required.&quot;)),
<span class="nc" id="L119">    INVALID_REQUIRED_ACKS(21,</span>
            new InvalidRequiredAcksException(&quot;Produce request specified an invalid value for required acks.&quot;)),
<span class="nc" id="L121">    ILLEGAL_GENERATION(22,</span>
            new IllegalGenerationException(&quot;Specified group generation id is not valid.&quot;)),
<span class="nc" id="L123">    INCONSISTENT_GROUP_PROTOCOL(23,</span>
            new InconsistentGroupProtocolException(&quot;The group member's supported protocols are incompatible with those of existing members.&quot;)),
<span class="nc" id="L125">    INVALID_GROUP_ID(24,</span>
            new InvalidGroupIdException(&quot;The configured groupId is invalid&quot;)),
<span class="nc" id="L127">    UNKNOWN_MEMBER_ID(25,</span>
            new UnknownMemberIdException(&quot;The coordinator is not aware of this member.&quot;)),
<span class="nc" id="L129">    INVALID_SESSION_TIMEOUT(26,</span>
            new InvalidSessionTimeoutException(&quot;The session timeout is not within the range allowed by the broker &quot; +
                    &quot;(as configured by group.min.session.timeout.ms and group.max.session.timeout.ms).&quot;)),
<span class="nc" id="L132">    REBALANCE_IN_PROGRESS(27,</span>
            new RebalanceInProgressException(&quot;The group is rebalancing, so a rejoin is needed.&quot;)),
<span class="nc" id="L134">    INVALID_COMMIT_OFFSET_SIZE(28,</span>
            new InvalidCommitOffsetSizeException(&quot;The committing offset data size is not valid&quot;)),
<span class="nc" id="L136">    TOPIC_AUTHORIZATION_FAILED(29,</span>
            new TopicAuthorizationException(&quot;Topic authorization failed.&quot;)),
<span class="nc" id="L138">    GROUP_AUTHORIZATION_FAILED(30,</span>
            new GroupAuthorizationException(&quot;Group authorization failed.&quot;)),
<span class="nc" id="L140">    CLUSTER_AUTHORIZATION_FAILED(31,</span>
            new ClusterAuthorizationException(&quot;Cluster authorization failed.&quot;)),
<span class="nc" id="L142">    INVALID_TIMESTAMP(32,</span>
            new InvalidTimestampException(&quot;The timestamp of the message is out of acceptable range.&quot;)),
<span class="nc" id="L144">    UNSUPPORTED_SASL_MECHANISM(33,</span>
            new UnsupportedSaslMechanismException(&quot;The broker does not support the requested SASL mechanism.&quot;)),
<span class="nc" id="L146">    ILLEGAL_SASL_STATE(34,</span>
            new IllegalSaslStateException(&quot;Request is not valid given the current SASL state.&quot;)),
<span class="nc" id="L148">    UNSUPPORTED_VERSION(35,</span>
            new UnsupportedVersionException(&quot;The version of API is not supported.&quot;)),
<span class="nc" id="L150">    TOPIC_ALREADY_EXISTS(36,</span>
            new TopicExistsException(&quot;Topic with this name already exists.&quot;)),
<span class="nc" id="L152">    INVALID_PARTITIONS(37,</span>
            new InvalidPartitionsException(&quot;Number of partitions is invalid.&quot;)),
<span class="nc" id="L154">    INVALID_REPLICATION_FACTOR(38,</span>
            new InvalidReplicationFactorException(&quot;Replication-factor is invalid.&quot;)),
<span class="nc" id="L156">    INVALID_REPLICA_ASSIGNMENT(39,</span>
            new InvalidReplicaAssignmentException(&quot;Replica assignment is invalid.&quot;)),
<span class="nc" id="L158">    INVALID_CONFIG(40,</span>
            new InvalidConfigurationException(&quot;Configuration is invalid.&quot;)),
<span class="nc" id="L160">    NOT_CONTROLLER(41,</span>
        new NotControllerException(&quot;This is not the correct controller for this cluster.&quot;)),
<span class="nc" id="L162">    INVALID_REQUEST(42,</span>
        new InvalidRequestException(&quot;This most likely occurs because of a request being malformed by the client library or&quot; +
            &quot; the message was sent to an incompatible broker. See the broker logs for more details.&quot;));

<span class="nc" id="L166">    private static final Logger log = LoggerFactory.getLogger(Errors.class);</span>

<span class="nc" id="L168">    private static Map&lt;Class&lt;?&gt;, Errors&gt; classToError = new HashMap&lt;Class&lt;?&gt;, Errors&gt;();</span>
<span class="nc" id="L169">    private static Map&lt;Short, Errors&gt; codeToError = new HashMap&lt;Short, Errors&gt;();</span>

    static {
<span class="nc bnc" id="L172" title="All 2 branches missed.">        for (Errors error : Errors.values()) {</span>
<span class="nc" id="L173">            codeToError.put(error.code(), error);</span>
<span class="nc bnc" id="L174" title="All 2 branches missed.">            if (error.exception != null)</span>
<span class="nc" id="L175">                classToError.put(error.exception.getClass(), error);</span>
        }
<span class="nc" id="L177">    }</span>

    private final short code;
    private final ApiException exception;

<span class="nc" id="L182">    private Errors(int code, ApiException exception) {</span>
<span class="nc" id="L183">        this.code = (short) code;</span>
<span class="nc" id="L184">        this.exception = exception;</span>
<span class="nc" id="L185">    }</span>

    /**
     * An instance of the exception
     */
    public ApiException exception() {
<span class="nc" id="L191">        return this.exception;</span>
    }

    /**
     * Returns the class name of the exception or null if this is {@code Errors.NONE}.
     */
    public String exceptionName() {
<span class="nc bnc" id="L198" title="All 2 branches missed.">        return exception == null ? null : exception.getClass().getName();</span>
    }

    /**
     * The error code for the exception
     */
    public short code() {
<span class="nc" id="L205">        return this.code;</span>
    }

    /**
     * Throw the exception corresponding to this error if there is one
     */
    public void maybeThrow() {
<span class="nc bnc" id="L212" title="All 2 branches missed.">        if (exception != null) {</span>
<span class="nc" id="L213">            throw this.exception;</span>
        }
<span class="nc" id="L215">    }</span>

    /**
     * Get a friendly description of the error (if one is available).
     * @return the error message
     */
    public String message() {
<span class="nc bnc" id="L222" title="All 2 branches missed.">        if (exception != null)</span>
<span class="nc" id="L223">            return exception.getMessage();</span>
<span class="nc" id="L224">        return toString();</span>
    }

    /**
     * Throw the exception if there is one
     */
    public static Errors forCode(short code) {
<span class="nc" id="L231">        Errors error = codeToError.get(code);</span>
<span class="nc bnc" id="L232" title="All 2 branches missed.">        if (error != null) {</span>
<span class="nc" id="L233">            return error;</span>
        } else {
<span class="nc" id="L235">            log.warn(&quot;Unexpected error code: {}.&quot;, code);</span>
<span class="nc" id="L236">            return UNKNOWN;</span>
        }
    }

    /**
     * Return the error instance associated with this exception or any of its superclasses (or UNKNOWN if there is none).
     * If there are multiple matches in the class hierarchy, the first match starting from the bottom is used.
     */
    public static Errors forException(Throwable t) {
<span class="nc" id="L245">        Class&lt;?&gt; clazz = t.getClass();</span>
<span class="nc bnc" id="L246" title="All 2 branches missed.">        while (clazz != null) {</span>
<span class="nc" id="L247">            Errors error = classToError.get(clazz);</span>
<span class="nc bnc" id="L248" title="All 2 branches missed.">            if (error != null)</span>
<span class="nc" id="L249">                return error;</span>
<span class="nc" id="L250">            clazz = clazz.getSuperclass();</span>
<span class="nc" id="L251">        }</span>
<span class="nc" id="L252">        return UNKNOWN;</span>
    }

    private static String toHtml() {
<span class="nc" id="L256">        final StringBuilder b = new StringBuilder();</span>
<span class="nc" id="L257">        b.append(&quot;&lt;table class=\&quot;data-table\&quot;&gt;&lt;tbody&gt;\n&quot;);</span>
<span class="nc" id="L258">        b.append(&quot;&lt;tr&gt;&quot;);</span>
<span class="nc" id="L259">        b.append(&quot;&lt;th&gt;Error&lt;/th&gt;\n&quot;);</span>
<span class="nc" id="L260">        b.append(&quot;&lt;th&gt;Code&lt;/th&gt;\n&quot;);</span>
<span class="nc" id="L261">        b.append(&quot;&lt;th&gt;Retriable&lt;/th&gt;\n&quot;);</span>
<span class="nc" id="L262">        b.append(&quot;&lt;th&gt;Description&lt;/th&gt;\n&quot;);</span>
<span class="nc" id="L263">        b.append(&quot;&lt;/tr&gt;\n&quot;);</span>
<span class="nc bnc" id="L264" title="All 2 branches missed.">        for (Errors error : Errors.values()) {</span>
<span class="nc" id="L265">            b.append(&quot;&lt;tr&gt;&quot;);</span>
<span class="nc" id="L266">            b.append(&quot;&lt;td&gt;&quot;);</span>
<span class="nc" id="L267">            b.append(error.name());</span>
<span class="nc" id="L268">            b.append(&quot;&lt;/td&gt;&quot;);</span>
<span class="nc" id="L269">            b.append(&quot;&lt;td&gt;&quot;);</span>
<span class="nc" id="L270">            b.append(error.code());</span>
<span class="nc" id="L271">            b.append(&quot;&lt;/td&gt;&quot;);</span>
<span class="nc" id="L272">            b.append(&quot;&lt;td&gt;&quot;);</span>
<span class="nc bnc" id="L273" title="All 4 branches missed.">            b.append(error.exception() != null &amp;&amp; error.exception() instanceof RetriableException ? &quot;True&quot; : &quot;False&quot;);</span>
<span class="nc" id="L274">            b.append(&quot;&lt;/td&gt;&quot;);</span>
<span class="nc" id="L275">            b.append(&quot;&lt;td&gt;&quot;);</span>
<span class="nc bnc" id="L276" title="All 2 branches missed.">            b.append(error.exception() != null ? error.exception().getMessage() : &quot;&quot;);</span>
<span class="nc" id="L277">            b.append(&quot;&lt;/td&gt;&quot;);</span>
<span class="nc" id="L278">            b.append(&quot;&lt;/tr&gt;\n&quot;);</span>
        }
<span class="nc" id="L280">        b.append(&quot;&lt;/table&gt;\n&quot;);</span>
<span class="nc" id="L281">        return b.toString();</span>
    }

    public static void main(String[] args) {
<span class="nc" id="L285">        System.out.println(toHtml());</span>
<span class="nc" id="L286">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>