<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Protocol.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">v3io-kafka-client</a> &gt; <a href="index.source.html" class="el_package">org.apache.kafka.common.protocol</a> &gt; <span class="el_source">Protocol.java</span></div><h1>Protocol.java</h1><pre class="source lang-java linenums">/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.kafka.common.protocol;

import org.apache.kafka.common.protocol.types.ArrayOf;
import org.apache.kafka.common.protocol.types.Field;
import org.apache.kafka.common.protocol.types.Schema;
import org.apache.kafka.common.protocol.types.Type;

import java.util.LinkedHashMap;
import java.util.LinkedHashSet;
import java.util.Map;
import java.util.Set;

import static org.apache.kafka.common.protocol.types.Type.BOOLEAN;
import static org.apache.kafka.common.protocol.types.Type.BYTES;
import static org.apache.kafka.common.protocol.types.Type.INT16;
import static org.apache.kafka.common.protocol.types.Type.INT32;
import static org.apache.kafka.common.protocol.types.Type.INT64;
import static org.apache.kafka.common.protocol.types.Type.STRING;
import static org.apache.kafka.common.protocol.types.Type.NULLABLE_STRING;

<span class="nc" id="L37">public class Protocol {</span>

<span class="nc" id="L39">    public static final Schema REQUEST_HEADER = new Schema(new Field(&quot;api_key&quot;, INT16, &quot;The id of the request type.&quot;),</span>
                                                           new Field(&quot;api_version&quot;, INT16, &quot;The version of the API.&quot;),
                                                           new Field(&quot;correlation_id&quot;,
                                                                     INT32,
                                                                     &quot;A user-supplied integer value that will be passed back with the response&quot;),
                                                           new Field(&quot;client_id&quot;,
                                                                     NULLABLE_STRING,
                                                                     &quot;A user specified identifier for the client making the request.&quot;,
                                                                     &quot;&quot;));

<span class="nc" id="L49">    public static final Schema RESPONSE_HEADER = new Schema(new Field(&quot;correlation_id&quot;,</span>
                                                                      INT32,
                                                                      &quot;The user-supplied value passed in with the request&quot;));

    /* Metadata api */

<span class="nc" id="L55">    public static final Schema METADATA_REQUEST_V0 = new Schema(new Field(&quot;topics&quot;,</span>
                                                                          new ArrayOf(STRING),
                                                                          &quot;An array of topics to fetch metadata for. If no topics are specified fetch metadata for all topics.&quot;));

<span class="nc" id="L59">    public static final Schema METADATA_REQUEST_V1 = new Schema(new Field(&quot;topics&quot;,</span>
<span class="nc" id="L60">                                                                          ArrayOf.nullable(STRING),</span>
                                                                          &quot;An array of topics to fetch metadata for. If the topics array is null fetch metadata for all topics.&quot;));

    /* The v2 metadata request is the same as v1. An additional field for cluster id has been added to the v2 metadata response */
<span class="nc" id="L64">    public static final Schema METADATA_REQUEST_V2 = METADATA_REQUEST_V1;</span>

<span class="nc" id="L66">    public static final Schema METADATA_BROKER_V0 = new Schema(new Field(&quot;node_id&quot;, INT32, &quot;The broker id.&quot;),</span>
                                                   new Field(&quot;host&quot;, STRING, &quot;The hostname of the broker.&quot;),
                                                   new Field(&quot;port&quot;, INT32,
                                                             &quot;The port on which the broker accepts requests.&quot;));

<span class="nc" id="L71">    public static final Schema PARTITION_METADATA_V0 = new Schema(new Field(&quot;partition_error_code&quot;,</span>
                                                                            INT16,
                                                                            &quot;The error code for the partition, if any.&quot;),
                                                                  new Field(&quot;partition_id&quot;,
                                                                            INT32,
                                                                            &quot;The id of the partition.&quot;),
                                                                  new Field(&quot;leader&quot;,
                                                                            INT32,
                                                                            &quot;The id of the broker acting as leader for this partition.&quot;),
                                                                  new Field(&quot;replicas&quot;,
                                                                            new ArrayOf(INT32),
                                                                            &quot;The set of all nodes that host this partition.&quot;),
                                                                  new Field(&quot;isr&quot;,
                                                                            new ArrayOf(INT32),
                                                                            &quot;The set of nodes that are in sync with the leader for this partition.&quot;));

<span class="nc" id="L87">    public static final Schema TOPIC_METADATA_V0 = new Schema(new Field(&quot;topic_error_code&quot;,</span>
                                                                        INT16,
                                                                        &quot;The error code for the given topic.&quot;),
                                                              new Field(&quot;topic&quot;, STRING, &quot;The name of the topic&quot;),
                                                              new Field(&quot;partition_metadata&quot;,
                                                                        new ArrayOf(PARTITION_METADATA_V0),
                                                                        &quot;Metadata for each partition of the topic.&quot;));

<span class="nc" id="L95">    public static final Schema METADATA_RESPONSE_V0 = new Schema(new Field(&quot;brokers&quot;,</span>
                                                                           new ArrayOf(METADATA_BROKER_V0),
                                                                           &quot;Host and port information for all brokers.&quot;),
                                                                 new Field(&quot;topic_metadata&quot;,
                                                                           new ArrayOf(TOPIC_METADATA_V0)));

<span class="nc" id="L101">    public static final Schema METADATA_BROKER_V1 = new Schema(new Field(&quot;node_id&quot;, INT32, &quot;The broker id.&quot;),</span>
                                                      new Field(&quot;host&quot;, STRING, &quot;The hostname of the broker.&quot;),
                                                      new Field(&quot;port&quot;, INT32,
                                                        &quot;The port on which the broker accepts requests.&quot;),
                                                      new Field(&quot;rack&quot;, NULLABLE_STRING, &quot;The rack of the broker.&quot;));

<span class="nc" id="L107">    public static final Schema PARTITION_METADATA_V1 = PARTITION_METADATA_V0;</span>

<span class="nc" id="L109">    public static final Schema TOPIC_METADATA_V1 = new Schema(new Field(&quot;topic_error_code&quot;, INT16, &quot;The error code for the given topic.&quot;),</span>
                                                              new Field(&quot;topic&quot;, STRING, &quot;The name of the topic&quot;),
                                                              new Field(&quot;is_internal&quot;, BOOLEAN,
                                                                  &quot;Indicates if the topic is considered a Kafka internal topic&quot;),
                                                              new Field(&quot;partition_metadata&quot;, new ArrayOf(PARTITION_METADATA_V1),
                                                                &quot;Metadata for each partition of the topic.&quot;));

<span class="nc" id="L116">    public static final Schema METADATA_RESPONSE_V1 = new Schema(new Field(&quot;brokers&quot;, new ArrayOf(METADATA_BROKER_V1),</span>
                                                                    &quot;Host and port information for all brokers.&quot;),
                                                                 new Field(&quot;controller_id&quot;, INT32,
                                                                     &quot;The broker id of the controller broker.&quot;),
                                                                 new Field(&quot;topic_metadata&quot;, new ArrayOf(TOPIC_METADATA_V1)));

<span class="nc" id="L122">    public static final Schema METADATA_RESPONSE_V2 = new Schema(new Field(&quot;brokers&quot;, new ArrayOf(METADATA_BROKER_V1),</span>
                                                                    &quot;Host and port information for all brokers.&quot;),
                                                                 new Field(&quot;cluster_id&quot;, NULLABLE_STRING,
                                                                     &quot;The cluster id that this broker belongs to.&quot;),
                                                                 new Field(&quot;controller_id&quot;, INT32,
                                                                     &quot;The broker id of the controller broker.&quot;),
                                                                 new Field(&quot;topic_metadata&quot;, new ArrayOf(TOPIC_METADATA_V1)));


<span class="nc" id="L131">    public static final Schema[] METADATA_REQUEST = new Schema[] {METADATA_REQUEST_V0, METADATA_REQUEST_V1, METADATA_REQUEST_V2};</span>
<span class="nc" id="L132">    public static final Schema[] METADATA_RESPONSE = new Schema[] {METADATA_RESPONSE_V0, METADATA_RESPONSE_V1, METADATA_RESPONSE_V2};</span>

    /* Produce api */

<span class="nc" id="L136">    public static final Schema TOPIC_PRODUCE_DATA_V0 = new Schema(new Field(&quot;topic&quot;, STRING),</span>
                                                                  new Field(&quot;data&quot;, new ArrayOf(new Schema(new Field(&quot;partition&quot;, INT32),
                                                                                                     new Field(&quot;record_set&quot;, BYTES)))));

<span class="nc" id="L140">    public static final Schema PRODUCE_REQUEST_V0 = new Schema(new Field(&quot;acks&quot;,</span>
                                                                   INT16,
                                                                   &quot;The number of acknowledgments the producer requires the leader to have received before considering a request complete. Allowed values: 0 for no acknowledgments, 1 for only the leader and -1 for the full ISR.&quot;),
                                                               new Field(&quot;timeout&quot;, INT32, &quot;The time to await a response in ms.&quot;),
                                                               new Field(&quot;topic_data&quot;, new ArrayOf(TOPIC_PRODUCE_DATA_V0)));

<span class="nc" id="L146">    public static final Schema PRODUCE_RESPONSE_V0 = new Schema(new Field(&quot;responses&quot;,</span>
                                                                    new ArrayOf(new Schema(new Field(&quot;topic&quot;, STRING),
                                                                                           new Field(&quot;partition_responses&quot;,
                                                                                                     new ArrayOf(new Schema(new Field(&quot;partition&quot;,
                                                                                                                                      INT32),
                                                                                                                            new Field(&quot;error_code&quot;,
                                                                                                                                      INT16),
                                                                                                                            new Field(&quot;base_offset&quot;,
                                                                                                                                      INT64))))))));
    /**
     * The body of PRODUCE_REQUEST_V1 is the same as PRODUCE_REQUEST_V0.
     * The version number is bumped up to indicate that the client supports quota throttle time field in the response.
     */
<span class="nc" id="L159">    public static final Schema PRODUCE_REQUEST_V1 = PRODUCE_REQUEST_V0;</span>
    /**
     * The body of PRODUCE_REQUEST_V2 is the same as PRODUCE_REQUEST_V1.
     * The version number is bumped up to indicate that message format V1 is used which has relative offset and
     * timestamp.
     */
<span class="nc" id="L165">    public static final Schema PRODUCE_REQUEST_V2 = PRODUCE_REQUEST_V1;</span>

<span class="nc" id="L167">    public static final Schema PRODUCE_RESPONSE_V1 = new Schema(new Field(&quot;responses&quot;,</span>
                                                                          new ArrayOf(new Schema(new Field(&quot;topic&quot;, STRING),
                                                                                                 new Field(&quot;partition_responses&quot;,
                                                                                                           new ArrayOf(new Schema(new Field(&quot;partition&quot;,
                                                                                                                                            INT32),
                                                                                                                                  new Field(&quot;error_code&quot;,
                                                                                                                                            INT16),
                                                                                                                                  new Field(&quot;base_offset&quot;,
                                                                                                                                            INT64))))))),
                                                                new Field(&quot;throttle_time_ms&quot;,
                                                                          INT32,
                                                                          &quot;Duration in milliseconds for which the request was throttled&quot; +
                                                                              &quot; due to quota violation. (Zero if the request did not violate any quota.)&quot;,
<span class="nc" id="L180">                                                                          0));</span>
    /**
     * PRODUCE_RESPONSE_V2 added a timestamp field in the per partition response status.
     * The timestamp is log append time if the topic is configured to use log append time. Or it is NoTimestamp when create
     * time is used for the topic.
     */
<span class="nc" id="L186">    public static final Schema PRODUCE_RESPONSE_V2 = new Schema(new Field(&quot;responses&quot;,</span>
                                                                new ArrayOf(new Schema(new Field(&quot;topic&quot;, STRING),
                                                                                       new Field(&quot;partition_responses&quot;,
                                                                                       new ArrayOf(new Schema(new Field(&quot;partition&quot;,
                                                                                                                        INT32),
                                                                                                              new Field(&quot;error_code&quot;,
                                                                                                                        INT16),
                                                                                                              new Field(&quot;base_offset&quot;,
                                                                                                                        INT64),
                                                                                                              new Field(&quot;timestamp&quot;,
                                                                                                                        INT64,
                                                                                                                        &quot;The timestamp returned by broker after appending the messages. &quot; +
                                                                                                                            &quot;If CreateTime is used for the topic, the timestamp will be -1. &quot; +
                                                                                                                            &quot;If LogAppendTime is used for the topic, the timestamp will be &quot; +
                                                                                                                            &quot;the broker local time when the messages are appended.&quot;))))))),
                                                                new Field(&quot;throttle_time_ms&quot;,
                                                                          INT32,
                                                                          &quot;Duration in milliseconds for which the request was throttled&quot; +
                                                                              &quot; due to quota violation. (Zero if the request did not violate any quota.)&quot;,
<span class="nc" id="L205">                                                                          0));</span>
<span class="nc" id="L206">    public static final Schema[] PRODUCE_REQUEST = new Schema[] {PRODUCE_REQUEST_V0, PRODUCE_REQUEST_V1, PRODUCE_REQUEST_V2};</span>
<span class="nc" id="L207">    public static final Schema[] PRODUCE_RESPONSE = new Schema[] {PRODUCE_RESPONSE_V0, PRODUCE_RESPONSE_V1, PRODUCE_RESPONSE_V2};</span>

    /* Offset commit api */
<span class="nc" id="L210">    public static final Schema OFFSET_COMMIT_REQUEST_PARTITION_V0 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                         INT32,
                                                                                         &quot;Topic partition id.&quot;),
                                                                               new Field(&quot;offset&quot;,
                                                                                         INT64,
                                                                                         &quot;Message offset to be committed.&quot;),
                                                                               new Field(&quot;metadata&quot;,
                                                                                         NULLABLE_STRING,
                                                                                         &quot;Any associated metadata the client wants to keep.&quot;));

<span class="nc" id="L220">    public static final Schema OFFSET_COMMIT_REQUEST_PARTITION_V1 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                         INT32,
                                                                                         &quot;Topic partition id.&quot;),
                                                                               new Field(&quot;offset&quot;,
                                                                                         INT64,
                                                                                         &quot;Message offset to be committed.&quot;),
                                                                               new Field(&quot;timestamp&quot;,
                                                                                         INT64,
                                                                                         &quot;Timestamp of the commit&quot;),
                                                                               new Field(&quot;metadata&quot;,
                                                                                         NULLABLE_STRING,
                                                                                         &quot;Any associated metadata the client wants to keep.&quot;));

<span class="nc" id="L233">    public static final Schema OFFSET_COMMIT_REQUEST_PARTITION_V2 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                         INT32,
                                                                                         &quot;Topic partition id.&quot;),
                                                                               new Field(&quot;offset&quot;,
                                                                                         INT64,
                                                                                         &quot;Message offset to be committed.&quot;),
                                                                               new Field(&quot;metadata&quot;,
                                                                                         NULLABLE_STRING,
                                                                                         &quot;Any associated metadata the client wants to keep.&quot;));

<span class="nc" id="L243">    public static final Schema OFFSET_COMMIT_REQUEST_TOPIC_V0 = new Schema(new Field(&quot;topic&quot;,</span>
                                                                                     STRING,
                                                                                     &quot;Topic to commit.&quot;),
                                                                           new Field(&quot;partitions&quot;,
                                                                                     new ArrayOf(OFFSET_COMMIT_REQUEST_PARTITION_V0),
                                                                                     &quot;Partitions to commit offsets.&quot;));

<span class="nc" id="L250">    public static final Schema OFFSET_COMMIT_REQUEST_TOPIC_V1 = new Schema(new Field(&quot;topic&quot;,</span>
                                                                                     STRING,
                                                                                     &quot;Topic to commit.&quot;),
                                                                           new Field(&quot;partitions&quot;,
                                                                                     new ArrayOf(OFFSET_COMMIT_REQUEST_PARTITION_V1),
                                                                                     &quot;Partitions to commit offsets.&quot;));

<span class="nc" id="L257">    public static final Schema OFFSET_COMMIT_REQUEST_TOPIC_V2 = new Schema(new Field(&quot;topic&quot;,</span>
                                                                                     STRING,
                                                                                     &quot;Topic to commit.&quot;),
                                                                           new Field(&quot;partitions&quot;,
                                                                                     new ArrayOf(OFFSET_COMMIT_REQUEST_PARTITION_V2),
                                                                                     &quot;Partitions to commit offsets.&quot;));

<span class="nc" id="L264">    public static final Schema OFFSET_COMMIT_REQUEST_V0 = new Schema(new Field(&quot;group_id&quot;,</span>
                                                                               STRING,
                                                                               &quot;The group id.&quot;),
                                                                     new Field(&quot;topics&quot;,
                                                                               new ArrayOf(OFFSET_COMMIT_REQUEST_TOPIC_V0),
                                                                               &quot;Topics to commit offsets.&quot;));

<span class="nc" id="L271">    public static final Schema OFFSET_COMMIT_REQUEST_V1 = new Schema(new Field(&quot;group_id&quot;,</span>
                                                                               STRING,
                                                                               &quot;The group id.&quot;),
                                                                     new Field(&quot;group_generation_id&quot;,
                                                                               INT32,
                                                                               &quot;The generation of the group.&quot;),
                                                                     new Field(&quot;member_id&quot;,
                                                                               STRING,
                                                                               &quot;The member id assigned by the group coordinator.&quot;),
                                                                     new Field(&quot;topics&quot;,
                                                                               new ArrayOf(OFFSET_COMMIT_REQUEST_TOPIC_V1),
                                                                               &quot;Topics to commit offsets.&quot;));

<span class="nc" id="L284">    public static final Schema OFFSET_COMMIT_REQUEST_V2 = new Schema(new Field(&quot;group_id&quot;,</span>
                                                                               STRING,
                                                                               &quot;The group id.&quot;),
                                                                     new Field(&quot;group_generation_id&quot;,
                                                                               INT32,
                                                                               &quot;The generation of the consumer group.&quot;),
                                                                     new Field(&quot;member_id&quot;,
                                                                               STRING,
                                                                               &quot;The consumer id assigned by the group coordinator.&quot;),
                                                                     new Field(&quot;retention_time&quot;,
                                                                               INT64,
                                                                               &quot;Time period in ms to retain the offset.&quot;),
                                                                     new Field(&quot;topics&quot;,
                                                                               new ArrayOf(OFFSET_COMMIT_REQUEST_TOPIC_V2),
                                                                               &quot;Topics to commit offsets.&quot;));

<span class="nc" id="L300">    public static final Schema OFFSET_COMMIT_RESPONSE_PARTITION_V0 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                          INT32,
                                                                                          &quot;Topic partition id.&quot;),
                                                                                new Field(&quot;error_code&quot;,
                                                                                          INT16));

<span class="nc" id="L306">    public static final Schema OFFSET_COMMIT_RESPONSE_TOPIC_V0 = new Schema(new Field(&quot;topic&quot;, STRING),</span>
                                                                            new Field(&quot;partition_responses&quot;,
                                                                                      new ArrayOf(OFFSET_COMMIT_RESPONSE_PARTITION_V0)));

<span class="nc" id="L310">    public static final Schema OFFSET_COMMIT_RESPONSE_V0 = new Schema(new Field(&quot;responses&quot;,</span>
                                                                                new ArrayOf(OFFSET_COMMIT_RESPONSE_TOPIC_V0)));

<span class="nc" id="L313">    public static final Schema[] OFFSET_COMMIT_REQUEST = new Schema[] {OFFSET_COMMIT_REQUEST_V0, OFFSET_COMMIT_REQUEST_V1, OFFSET_COMMIT_REQUEST_V2};</span>

    /* The response types for V0, V1 and V2 of OFFSET_COMMIT_REQUEST are the same. */
<span class="nc" id="L316">    public static final Schema OFFSET_COMMIT_RESPONSE_V1 = OFFSET_COMMIT_RESPONSE_V0;</span>
<span class="nc" id="L317">    public static final Schema OFFSET_COMMIT_RESPONSE_V2 = OFFSET_COMMIT_RESPONSE_V0;</span>

<span class="nc" id="L319">    public static final Schema[] OFFSET_COMMIT_RESPONSE = new Schema[] {OFFSET_COMMIT_RESPONSE_V0, OFFSET_COMMIT_RESPONSE_V1, OFFSET_COMMIT_RESPONSE_V2};</span>

    /* Offset fetch api */

    /*
     * Wire formats of version 0 and 1 are the same, but with different functionality.
     * Version 0 will read the offsets from ZK;
     * Version 1 will read the offsets from Kafka.
     */
<span class="nc" id="L328">    public static final Schema OFFSET_FETCH_REQUEST_PARTITION_V0 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                        INT32,
                                                                                        &quot;Topic partition id.&quot;));

<span class="nc" id="L332">    public static final Schema OFFSET_FETCH_REQUEST_TOPIC_V0 = new Schema(new Field(&quot;topic&quot;,</span>
                                                                                    STRING,
                                                                                    &quot;Topic to fetch offset.&quot;),
                                                                          new Field(&quot;partitions&quot;,
                                                                                    new ArrayOf(OFFSET_FETCH_REQUEST_PARTITION_V0),
                                                                                    &quot;Partitions to fetch offsets.&quot;));

<span class="nc" id="L339">    public static final Schema OFFSET_FETCH_REQUEST_V0 = new Schema(new Field(&quot;group_id&quot;,</span>
                                                                              STRING,
                                                                              &quot;The consumer group id.&quot;),
                                                                    new Field(&quot;topics&quot;,
                                                                              new ArrayOf(OFFSET_FETCH_REQUEST_TOPIC_V0),
                                                                              &quot;Topics to fetch offsets.&quot;));

<span class="nc" id="L346">    public static final Schema OFFSET_FETCH_RESPONSE_PARTITION_V0 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                         INT32,
                                                                                         &quot;Topic partition id.&quot;),
                                                                               new Field(&quot;offset&quot;,
                                                                                         INT64,
                                                                                         &quot;Last committed message offset.&quot;),
                                                                               new Field(&quot;metadata&quot;,
                                                                                         NULLABLE_STRING,
                                                                                         &quot;Any associated metadata the client wants to keep.&quot;),
                                                                               new Field(&quot;error_code&quot;, INT16));

<span class="nc" id="L357">    public static final Schema OFFSET_FETCH_RESPONSE_TOPIC_V0 = new Schema(new Field(&quot;topic&quot;, STRING),</span>
                                                                           new Field(&quot;partition_responses&quot;,
                                                                                     new ArrayOf(OFFSET_FETCH_RESPONSE_PARTITION_V0)));

<span class="nc" id="L361">    public static final Schema OFFSET_FETCH_RESPONSE_V0 = new Schema(new Field(&quot;responses&quot;,</span>
                                                                               new ArrayOf(OFFSET_FETCH_RESPONSE_TOPIC_V0)));

<span class="nc" id="L364">    public static final Schema OFFSET_FETCH_REQUEST_V1 = OFFSET_FETCH_REQUEST_V0;</span>
<span class="nc" id="L365">    public static final Schema OFFSET_FETCH_RESPONSE_V1 = OFFSET_FETCH_RESPONSE_V0;</span>

<span class="nc" id="L367">    public static final Schema[] OFFSET_FETCH_REQUEST = new Schema[] {OFFSET_FETCH_REQUEST_V0, OFFSET_FETCH_REQUEST_V1};</span>
<span class="nc" id="L368">    public static final Schema[] OFFSET_FETCH_RESPONSE = new Schema[] {OFFSET_FETCH_RESPONSE_V0, OFFSET_FETCH_RESPONSE_V1};</span>

    /* List offset api */
<span class="nc" id="L371">    public static final Schema LIST_OFFSET_REQUEST_PARTITION_V0 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                       INT32,
                                                                                       &quot;Topic partition id.&quot;),
                                                                             new Field(&quot;timestamp&quot;, INT64, &quot;Timestamp.&quot;),
                                                                             new Field(&quot;max_num_offsets&quot;,
                                                                                       INT32,
                                                                                       &quot;Maximum offsets to return.&quot;));
<span class="nc" id="L378">    public static final Schema LIST_OFFSET_REQUEST_PARTITION_V1 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                       INT32,
                                                                                       &quot;Topic partition id.&quot;),
                                                                             new Field(&quot;timestamp&quot;,
                                                                                       INT64,
                                                                                       &quot;The target timestamp for the partition.&quot;));

<span class="nc" id="L385">    public static final Schema LIST_OFFSET_REQUEST_TOPIC_V0 = new Schema(new Field(&quot;topic&quot;,</span>
                                                                                   STRING,
                                                                                   &quot;Topic to list offset.&quot;),
                                                                         new Field(&quot;partitions&quot;,
                                                                                   new ArrayOf(LIST_OFFSET_REQUEST_PARTITION_V0),
                                                                                   &quot;Partitions to list offset.&quot;));
<span class="nc" id="L391">    public static final Schema LIST_OFFSET_REQUEST_TOPIC_V1 = new Schema(new Field(&quot;topic&quot;,</span>
                                                                                   STRING,
                                                                                   &quot;Topic to list offset.&quot;),
                                                                         new Field(&quot;partitions&quot;,
                                                                                   new ArrayOf(LIST_OFFSET_REQUEST_PARTITION_V1),
                                                                                   &quot;Partitions to list offset.&quot;));

<span class="nc" id="L398">    public static final Schema LIST_OFFSET_REQUEST_V0 = new Schema(new Field(&quot;replica_id&quot;,</span>
                                                                             INT32,
                                                                             &quot;Broker id of the follower. For normal consumers, use -1.&quot;),
                                                                   new Field(&quot;topics&quot;,
                                                                             new ArrayOf(LIST_OFFSET_REQUEST_TOPIC_V0),
                                                                             &quot;Topics to list offsets.&quot;));
<span class="nc" id="L404">    public static final Schema LIST_OFFSET_REQUEST_V1 = new Schema(new Field(&quot;replica_id&quot;,</span>
                                                                             INT32,
                                                                             &quot;Broker id of the follower. For normal consumers, use -1.&quot;),
                                                                   new Field(&quot;topics&quot;,
                                                                             new ArrayOf(LIST_OFFSET_REQUEST_TOPIC_V1),
                                                                             &quot;Topics to list offsets.&quot;));

<span class="nc" id="L411">    public static final Schema LIST_OFFSET_RESPONSE_PARTITION_V0 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                        INT32,
                                                                                        &quot;Topic partition id.&quot;),
                                                                              new Field(&quot;error_code&quot;, INT16),
                                                                              new Field(&quot;offsets&quot;,
                                                                                        new ArrayOf(INT64),
                                                                                        &quot;A list of offsets.&quot;));

<span class="nc" id="L419">    public static final Schema LIST_OFFSET_RESPONSE_PARTITION_V1 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                        INT32,
                                                                                        &quot;Topic partition id.&quot;),
                                                                              new Field(&quot;error_code&quot;, INT16),
                                                                              new Field(&quot;timestamp&quot;,
                                                                                        INT64,
                                                                                        &quot;The timestamp associated with the returned offset&quot;),
                                                                              new Field(&quot;offset&quot;,
                                                                                        INT64,
                                                                                        &quot;offsets found&quot;));

<span class="nc" id="L430">    public static final Schema LIST_OFFSET_RESPONSE_TOPIC_V0 = new Schema(new Field(&quot;topic&quot;, STRING),</span>
                                                                          new Field(&quot;partition_responses&quot;,
                                                                                    new ArrayOf(LIST_OFFSET_RESPONSE_PARTITION_V0)));

<span class="nc" id="L434">    public static final Schema LIST_OFFSET_RESPONSE_TOPIC_V1 = new Schema(new Field(&quot;topic&quot;, STRING),</span>
                                                                          new Field(&quot;partition_responses&quot;,
                                                                                    new ArrayOf(LIST_OFFSET_RESPONSE_PARTITION_V1)));

<span class="nc" id="L438">    public static final Schema LIST_OFFSET_RESPONSE_V0 = new Schema(new Field(&quot;responses&quot;,</span>
                                                                              new ArrayOf(LIST_OFFSET_RESPONSE_TOPIC_V0)));

<span class="nc" id="L441">    public static final Schema LIST_OFFSET_RESPONSE_V1 = new Schema(new Field(&quot;responses&quot;,</span>
                                                                              new ArrayOf(LIST_OFFSET_RESPONSE_TOPIC_V1)));

<span class="nc" id="L444">    public static final Schema[] LIST_OFFSET_REQUEST = new Schema[] {LIST_OFFSET_REQUEST_V0, LIST_OFFSET_REQUEST_V1};</span>
<span class="nc" id="L445">    public static final Schema[] LIST_OFFSET_RESPONSE = new Schema[] {LIST_OFFSET_RESPONSE_V0, LIST_OFFSET_RESPONSE_V1};</span>

    /* Fetch api */
<span class="nc" id="L448">    public static final Schema FETCH_REQUEST_PARTITION_V0 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                 INT32,
                                                                                 &quot;Topic partition id.&quot;),
                                                                       new Field(&quot;fetch_offset&quot;,
                                                                                 INT64,
                                                                                 &quot;Message offset.&quot;),
                                                                       new Field(&quot;max_bytes&quot;,
                                                                                 INT32,
                                                                                 &quot;Maximum bytes to fetch.&quot;));

<span class="nc" id="L458">    public static final Schema FETCH_REQUEST_TOPIC_V0 = new Schema(new Field(&quot;topic&quot;, STRING, &quot;Topic to fetch.&quot;),</span>
                                                                   new Field(&quot;partitions&quot;,
                                                                             new ArrayOf(FETCH_REQUEST_PARTITION_V0),
                                                                             &quot;Partitions to fetch.&quot;));

<span class="nc" id="L463">    public static final Schema FETCH_REQUEST_V0 = new Schema(new Field(&quot;replica_id&quot;,</span>
                                                                       INT32,
                                                                       &quot;Broker id of the follower. For normal consumers, use -1.&quot;),
                                                             new Field(&quot;max_wait_time&quot;,
                                                                       INT32,
                                                                       &quot;Maximum time in ms to wait for the response.&quot;),
                                                             new Field(&quot;min_bytes&quot;,
                                                                       INT32,
                                                                       &quot;Minimum bytes to accumulate in the response.&quot;),
                                                             new Field(&quot;topics&quot;,
                                                                       new ArrayOf(FETCH_REQUEST_TOPIC_V0),
                                                                       &quot;Topics to fetch.&quot;));

    // The V1 Fetch Request body is the same as V0.
    // Only the version number is incremented to indicate a newer client
<span class="nc" id="L478">    public static final Schema FETCH_REQUEST_V1 = FETCH_REQUEST_V0;</span>
    // The V2 Fetch Request body is the same as V1.
    // Only the version number is incremented to indicate the client support message format V1 which uses
    // relative offset and has timestamp.
<span class="nc" id="L482">    public static final Schema FETCH_REQUEST_V2 = FETCH_REQUEST_V1;</span>
    // FETCH_REQUEST_V3 added top level max_bytes field - the total size of partition data to accumulate in response.
    // The partition ordering is now relevant - partitions will be processed in order they appear in request.
<span class="nc" id="L485">    public static final Schema FETCH_REQUEST_V3 = new Schema(new Field(&quot;replica_id&quot;,</span>
                                                                       INT32,
                                                                       &quot;Broker id of the follower. For normal consumers, use -1.&quot;),
                                                             new Field(&quot;max_wait_time&quot;,
                                                                       INT32,
                                                                       &quot;Maximum time in ms to wait for the response.&quot;),
                                                             new Field(&quot;min_bytes&quot;,
                                                                       INT32,
                                                                       &quot;Minimum bytes to accumulate in the response.&quot;),
                                                             new Field(&quot;max_bytes&quot;,
                                                                       INT32,
                                                                       &quot;Maximum bytes to accumulate in the response. Note that this is not an absolute maximum, &quot; +
                                                                       &quot;if the first message in the first non-empty partition of the fetch is larger than this &quot; +
                                                                       &quot;value, the message will still be returned to ensure that progress can be made.&quot;),
                                                             new Field(&quot;topics&quot;,
                                                                       new ArrayOf(FETCH_REQUEST_TOPIC_V0),
                                                                       &quot;Topics to fetch in the order provided.&quot;));

<span class="nc" id="L503">    public static final Schema FETCH_RESPONSE_PARTITION_V0 = new Schema(new Field(&quot;partition&quot;,</span>
                                                                                  INT32,
                                                                                  &quot;Topic partition id.&quot;),
                                                                        new Field(&quot;error_code&quot;, INT16),
                                                                        new Field(&quot;high_watermark&quot;,
                                                                                  INT64,
                                                                                  &quot;Last committed offset.&quot;),
                                                                        new Field(&quot;record_set&quot;, BYTES));

<span class="nc" id="L512">    public static final Schema FETCH_RESPONSE_TOPIC_V0 = new Schema(new Field(&quot;topic&quot;, STRING),</span>
                                                                    new Field(&quot;partition_responses&quot;,
                                                                              new ArrayOf(FETCH_RESPONSE_PARTITION_V0)));

<span class="nc" id="L516">    public static final Schema FETCH_RESPONSE_V0 = new Schema(new Field(&quot;responses&quot;,</span>
                                                                        new ArrayOf(FETCH_RESPONSE_TOPIC_V0)));
<span class="nc" id="L518">    public static final Schema FETCH_RESPONSE_V1 = new Schema(new Field(&quot;throttle_time_ms&quot;,</span>
                                                                        INT32,
                                                                        &quot;Duration in milliseconds for which the request was throttled&quot; +
                                                                            &quot; due to quota violation. (Zero if the request did not violate any quota.)&quot;,
<span class="nc" id="L522">                                                                        0),</span>
                                                              new Field(&quot;responses&quot;,
                                                                      new ArrayOf(FETCH_RESPONSE_TOPIC_V0)));
    // Even though fetch response v2 has the same protocol as v1, the record set in the response is different. In v1,
    // record set only includes messages of v0 (magic byte 0). In v2, record set can include messages of v0 and v1
    // (magic byte 0 and 1). For details, see ByteBufferMessageSet.
<span class="nc" id="L528">    public static final Schema FETCH_RESPONSE_V2 = FETCH_RESPONSE_V1;</span>
<span class="nc" id="L529">    public static final Schema FETCH_RESPONSE_V3 = FETCH_RESPONSE_V2;</span>

<span class="nc" id="L531">    public static final Schema[] FETCH_REQUEST = new Schema[] {FETCH_REQUEST_V0, FETCH_REQUEST_V1, FETCH_REQUEST_V2, FETCH_REQUEST_V3};</span>
<span class="nc" id="L532">    public static final Schema[] FETCH_RESPONSE = new Schema[] {FETCH_RESPONSE_V0, FETCH_RESPONSE_V1, FETCH_RESPONSE_V2, FETCH_RESPONSE_V3};</span>

    /* List groups api */
<span class="nc" id="L535">    public static final Schema LIST_GROUPS_REQUEST_V0 = new Schema();</span>

<span class="nc" id="L537">    public static final Schema LIST_GROUPS_RESPONSE_GROUP_V0 = new Schema(new Field(&quot;group_id&quot;, STRING),</span>
                                                                          new Field(&quot;protocol_type&quot;, STRING));
<span class="nc" id="L539">    public static final Schema LIST_GROUPS_RESPONSE_V0 = new Schema(new Field(&quot;error_code&quot;, INT16),</span>
                                                                    new Field(&quot;groups&quot;, new ArrayOf(LIST_GROUPS_RESPONSE_GROUP_V0)));

<span class="nc" id="L542">    public static final Schema[] LIST_GROUPS_REQUEST = new Schema[] {LIST_GROUPS_REQUEST_V0};</span>
<span class="nc" id="L543">    public static final Schema[] LIST_GROUPS_RESPONSE = new Schema[] {LIST_GROUPS_RESPONSE_V0};</span>

    /* Describe group api */
<span class="nc" id="L546">    public static final Schema DESCRIBE_GROUPS_REQUEST_V0 = new Schema(new Field(&quot;group_ids&quot;,</span>
                                                                                 new ArrayOf(STRING),
                                                                                 &quot;List of groupIds to request metadata for (an empty groupId array will return empty group metadata).&quot;));

<span class="nc" id="L550">    public static final Schema DESCRIBE_GROUPS_RESPONSE_MEMBER_V0 = new Schema(new Field(&quot;member_id&quot;,</span>
                                                                                         STRING,
                                                                                         &quot;The memberId assigned by the coordinator&quot;),
                                                                               new Field(&quot;client_id&quot;,
                                                                                         STRING,
                                                                                         &quot;The client id used in the member's latest join group request&quot;),
                                                                               new Field(&quot;client_host&quot;,
                                                                                         STRING,
                                                                                         &quot;The client host used in the request session corresponding to the member's join group.&quot;),
                                                                               new Field(&quot;member_metadata&quot;,
                                                                                         BYTES,
                                                                                         &quot;The metadata corresponding to the current group protocol in use (will only be present if the group is stable).&quot;),
                                                                               new Field(&quot;member_assignment&quot;,
                                                                                         BYTES,
                                                                                         &quot;The current assignment provided by the group leader (will only be present if the group is stable).&quot;));

<span class="nc" id="L566">    public static final Schema DESCRIBE_GROUPS_RESPONSE_GROUP_METADATA_V0 = new Schema(new Field(&quot;error_code&quot;, INT16),</span>
                                                                                       new Field(&quot;group_id&quot;,
                                                                                                 STRING),
                                                                                       new Field(&quot;state&quot;,
                                                                                                 STRING,
                                                                                                 &quot;The current state of the group (one of: Dead, Stable, AwaitingSync, or PreparingRebalance, or empty if there is no active group)&quot;),
                                                                                       new Field(&quot;protocol_type&quot;,
                                                                                                 STRING,
                                                                                                 &quot;The current group protocol type (will be empty if there is no active group)&quot;),
                                                                                       new Field(&quot;protocol&quot;,
                                                                                                 STRING,
                                                                                                 &quot;The current group protocol (only provided if the group is Stable)&quot;),
                                                                                       new Field(&quot;members&quot;,
                                                                                                 new ArrayOf(DESCRIBE_GROUPS_RESPONSE_MEMBER_V0),
                                                                                                 &quot;Current group members (only provided if the group is not Dead)&quot;));

<span class="nc" id="L582">    public static final Schema DESCRIBE_GROUPS_RESPONSE_V0 = new Schema(new Field(&quot;groups&quot;, new ArrayOf(DESCRIBE_GROUPS_RESPONSE_GROUP_METADATA_V0)));</span>

<span class="nc" id="L584">    public static final Schema[] DESCRIBE_GROUPS_REQUEST = new Schema[] {DESCRIBE_GROUPS_REQUEST_V0};</span>
<span class="nc" id="L585">    public static final Schema[] DESCRIBE_GROUPS_RESPONSE = new Schema[] {DESCRIBE_GROUPS_RESPONSE_V0};</span>

    /* Group coordinator api */
<span class="nc" id="L588">    public static final Schema GROUP_COORDINATOR_REQUEST_V0 = new Schema(new Field(&quot;group_id&quot;,</span>
                                                                                   STRING,
                                                                                   &quot;The unique group id.&quot;));

<span class="nc" id="L592">    public static final Schema GROUP_COORDINATOR_BROKER_V0 = new Schema(new Field(&quot;node_id&quot;, INT32, &quot;The broker id.&quot;),</span>
                                                                        new Field(&quot;host&quot;, STRING, &quot;The hostname of the broker.&quot;),
                                                                        new Field(&quot;port&quot;, INT32,
                                                                            &quot;The port on which the broker accepts requests.&quot;));

<span class="nc" id="L597">    public static final Schema GROUP_COORDINATOR_RESPONSE_V0 = new Schema(new Field(&quot;error_code&quot;, INT16),</span>
                                                                          new Field(&quot;coordinator&quot;,
                                                                                    GROUP_COORDINATOR_BROKER_V0,
                                                                                    &quot;Host and port information for the coordinator for a consumer group.&quot;));

<span class="nc" id="L602">    public static final Schema[] GROUP_COORDINATOR_REQUEST = new Schema[] {GROUP_COORDINATOR_REQUEST_V0};</span>
<span class="nc" id="L603">    public static final Schema[] GROUP_COORDINATOR_RESPONSE = new Schema[] {GROUP_COORDINATOR_RESPONSE_V0};</span>

    /* Controlled shutdown api */
<span class="nc" id="L606">    public static final Schema CONTROLLED_SHUTDOWN_REQUEST_V1 = new Schema(new Field(&quot;broker_id&quot;,</span>
                                                                                     INT32,
                                                                                     &quot;The id of the broker for which controlled shutdown has been requested.&quot;));

<span class="nc" id="L610">    public static final Schema CONTROLLED_SHUTDOWN_PARTITION_V1 = new Schema(new Field(&quot;topic&quot;, STRING),</span>
                                                                             new Field(&quot;partition&quot;,
                                                                                       INT32,
                                                                                       &quot;Topic partition id.&quot;));

<span class="nc" id="L615">    public static final Schema CONTROLLED_SHUTDOWN_RESPONSE_V1 = new Schema(new Field(&quot;error_code&quot;, INT16),</span>
                                                                            new Field(&quot;partitions_remaining&quot;,
                                                                                      new ArrayOf(CONTROLLED_SHUTDOWN_PARTITION_V1),
                                                                                      &quot;The partitions that the broker still leads.&quot;));

    /* V0 is not supported as it would require changes to the request header not to include `clientId` */
<span class="nc" id="L621">    public static final Schema[] CONTROLLED_SHUTDOWN_REQUEST = new Schema[] {null, CONTROLLED_SHUTDOWN_REQUEST_V1};</span>
<span class="nc" id="L622">    public static final Schema[] CONTROLLED_SHUTDOWN_RESPONSE = new Schema[] {null, CONTROLLED_SHUTDOWN_RESPONSE_V1};</span>

    /* Join group api */
<span class="nc" id="L625">    public static final Schema JOIN_GROUP_REQUEST_PROTOCOL_V0 = new Schema(new Field(&quot;protocol_name&quot;, STRING),</span>
                                                                           new Field(&quot;protocol_metadata&quot;, BYTES));

<span class="nc" id="L628">    public static final Schema JOIN_GROUP_REQUEST_V0 = new Schema(new Field(&quot;group_id&quot;,</span>
                                                                            STRING,
                                                                            &quot;The group id.&quot;),
                                                                  new Field(&quot;session_timeout&quot;,
                                                                            INT32,
                                                                            &quot;The coordinator considers the consumer dead if it receives no heartbeat after this timeout in ms.&quot;),
                                                                  new Field(&quot;member_id&quot;,
                                                                            STRING,
                                                                            &quot;The assigned consumer id or an empty string for a new consumer.&quot;),
                                                                  new Field(&quot;protocol_type&quot;,
                                                                            STRING,
                                                                            &quot;Unique name for class of protocols implemented by group&quot;),
                                                                  new Field(&quot;group_protocols&quot;,
                                                                            new ArrayOf(JOIN_GROUP_REQUEST_PROTOCOL_V0),
                                                                            &quot;List of protocols that the member supports&quot;));

<span class="nc" id="L644">    public static final Schema JOIN_GROUP_REQUEST_V1 = new Schema(new Field(&quot;group_id&quot;,</span>
                                                                            STRING,
                                                                            &quot;The group id.&quot;),
                                                                  new Field(&quot;session_timeout&quot;,
                                                                            INT32,
                                                                            &quot;The coordinator considers the consumer dead if it receives no heartbeat after this timeout in ms.&quot;),
                                                                  new Field(&quot;rebalance_timeout&quot;,
                                                                            INT32,
                                                                            &quot;The maximum time that the coordinator will wait for each member to rejoin when rebalancing the group&quot;),
                                                                  new Field(&quot;member_id&quot;,
                                                                            STRING,
                                                                            &quot;The assigned consumer id or an empty string for a new consumer.&quot;),
                                                                  new Field(&quot;protocol_type&quot;,
                                                                            STRING,
                                                                            &quot;Unique name for class of protocols implemented by group&quot;),
                                                                  new Field(&quot;group_protocols&quot;,
                                                                            new ArrayOf(JOIN_GROUP_REQUEST_PROTOCOL_V0),
                                                                            &quot;List of protocols that the member supports&quot;));

<span class="nc" id="L663">    public static final Schema JOIN_GROUP_RESPONSE_MEMBER_V0 = new Schema(new Field(&quot;member_id&quot;, STRING),</span>
                                                                          new Field(&quot;member_metadata&quot;, BYTES));

<span class="nc" id="L666">    public static final Schema JOIN_GROUP_RESPONSE_V0 = new Schema(new Field(&quot;error_code&quot;, INT16),</span>
                                                                   new Field(&quot;generation_id&quot;,
                                                                             INT32,
                                                                             &quot;The generation of the consumer group.&quot;),
                                                                   new Field(&quot;group_protocol&quot;,
                                                                             STRING,
                                                                             &quot;The group protocol selected by the coordinator&quot;),
                                                                   new Field(&quot;leader_id&quot;,
                                                                             STRING,
                                                                             &quot;The leader of the group&quot;),
                                                                   new Field(&quot;member_id&quot;,
                                                                             STRING,
                                                                             &quot;The consumer id assigned by the group coordinator.&quot;),
                                                                   new Field(&quot;members&quot;,
                                                                             new ArrayOf(JOIN_GROUP_RESPONSE_MEMBER_V0)));

<span class="nc" id="L682">    public static final Schema JOIN_GROUP_RESPONSE_V1 = JOIN_GROUP_RESPONSE_V0;</span>

<span class="nc" id="L684">    public static final Schema[] JOIN_GROUP_REQUEST = new Schema[] {JOIN_GROUP_REQUEST_V0, JOIN_GROUP_REQUEST_V1};</span>
<span class="nc" id="L685">    public static final Schema[] JOIN_GROUP_RESPONSE = new Schema[] {JOIN_GROUP_RESPONSE_V0, JOIN_GROUP_RESPONSE_V1};</span>

    /* SyncGroup api */
<span class="nc" id="L688">    public static final Schema SYNC_GROUP_REQUEST_MEMBER_V0 = new Schema(new Field(&quot;member_id&quot;, STRING),</span>
                                                                         new Field(&quot;member_assignment&quot;, BYTES));
<span class="nc" id="L690">    public static final Schema SYNC_GROUP_REQUEST_V0 = new Schema(new Field(&quot;group_id&quot;, STRING),</span>
                                                                  new Field(&quot;generation_id&quot;, INT32),
                                                                  new Field(&quot;member_id&quot;, STRING),
                                                                  new Field(&quot;group_assignment&quot;, new ArrayOf(SYNC_GROUP_REQUEST_MEMBER_V0)));
<span class="nc" id="L694">    public static final Schema SYNC_GROUP_RESPONSE_V0 = new Schema(new Field(&quot;error_code&quot;, INT16),</span>
                                                                   new Field(&quot;member_assignment&quot;, BYTES));
<span class="nc" id="L696">    public static final Schema[] SYNC_GROUP_REQUEST = new Schema[] {SYNC_GROUP_REQUEST_V0};</span>
<span class="nc" id="L697">    public static final Schema[] SYNC_GROUP_RESPONSE = new Schema[] {SYNC_GROUP_RESPONSE_V0};</span>

    /* Heartbeat api */
<span class="nc" id="L700">    public static final Schema HEARTBEAT_REQUEST_V0 = new Schema(new Field(&quot;group_id&quot;, STRING, &quot;The group id.&quot;),</span>
                                                                 new Field(&quot;group_generation_id&quot;,
                                                                           INT32,
                                                                           &quot;The generation of the group.&quot;),
                                                                 new Field(&quot;member_id&quot;,
                                                                           STRING,
                                                                           &quot;The member id assigned by the group coordinator.&quot;));

<span class="nc" id="L708">    public static final Schema HEARTBEAT_RESPONSE_V0 = new Schema(new Field(&quot;error_code&quot;, INT16));</span>

<span class="nc" id="L710">    public static final Schema[] HEARTBEAT_REQUEST = new Schema[] {HEARTBEAT_REQUEST_V0};</span>
<span class="nc" id="L711">    public static final Schema[] HEARTBEAT_RESPONSE = new Schema[] {HEARTBEAT_RESPONSE_V0};</span>

    /* Leave group api */
<span class="nc" id="L714">    public static final Schema LEAVE_GROUP_REQUEST_V0 = new Schema(new Field(&quot;group_id&quot;, STRING, &quot;The group id.&quot;),</span>
                                                                   new Field(&quot;member_id&quot;,
                                                                             STRING,
                                                                             &quot;The member id assigned by the group coordinator.&quot;));

<span class="nc" id="L719">    public static final Schema LEAVE_GROUP_RESPONSE_V0 = new Schema(new Field(&quot;error_code&quot;, INT16));</span>

<span class="nc" id="L721">    public static final Schema[] LEAVE_GROUP_REQUEST = new Schema[] {LEAVE_GROUP_REQUEST_V0};</span>
<span class="nc" id="L722">    public static final Schema[] LEAVE_GROUP_RESPONSE = new Schema[] {LEAVE_GROUP_RESPONSE_V0};</span>

    /* Leader and ISR api */
<span class="nc" id="L725">    public static final Schema LEADER_AND_ISR_REQUEST_PARTITION_STATE_V0 =</span>
            new Schema(new Field(&quot;topic&quot;, STRING, &quot;Topic name.&quot;),
                       new Field(&quot;partition&quot;, INT32, &quot;Topic partition id.&quot;),
                       new Field(&quot;controller_epoch&quot;, INT32, &quot;The controller epoch.&quot;),
                       new Field(&quot;leader&quot;, INT32, &quot;The broker id for the leader.&quot;),
                       new Field(&quot;leader_epoch&quot;, INT32, &quot;The leader epoch.&quot;),
                       new Field(&quot;isr&quot;, new ArrayOf(INT32), &quot;The in sync replica ids.&quot;),
                       new Field(&quot;zk_version&quot;, INT32, &quot;The ZK version.&quot;),
                       new Field(&quot;replicas&quot;, new ArrayOf(INT32), &quot;The replica ids.&quot;));

<span class="nc" id="L735">    public static final Schema LEADER_AND_ISR_REQUEST_LIVE_LEADER_V0 =</span>
            new Schema(new Field(&quot;id&quot;, INT32, &quot;The broker id.&quot;),
                       new Field(&quot;host&quot;, STRING, &quot;The hostname of the broker.&quot;),
                       new Field(&quot;port&quot;, INT32, &quot;The port on which the broker accepts requests.&quot;));

<span class="nc" id="L740">    public static final Schema LEADER_AND_ISR_REQUEST_V0 = new Schema(new Field(&quot;controller_id&quot;, INT32, &quot;The controller id.&quot;),</span>
                                                                      new Field(&quot;controller_epoch&quot;, INT32, &quot;The controller epoch.&quot;),
                                                                      new Field(&quot;partition_states&quot;,
                                                                                new ArrayOf(LEADER_AND_ISR_REQUEST_PARTITION_STATE_V0)),
                                                                      new Field(&quot;live_leaders&quot;, new ArrayOf(LEADER_AND_ISR_REQUEST_LIVE_LEADER_V0)));

<span class="nc" id="L746">    public static final Schema LEADER_AND_ISR_RESPONSE_PARTITION_V0 = new Schema(new Field(&quot;topic&quot;, STRING, &quot;Topic name.&quot;),</span>
                                                                                 new Field(&quot;partition&quot;, INT32, &quot;Topic partition id.&quot;),
                                                                                 new Field(&quot;error_code&quot;, INT16, &quot;Error code.&quot;));

<span class="nc" id="L750">    public static final Schema LEADER_AND_ISR_RESPONSE_V0 = new Schema(new Field(&quot;error_code&quot;, INT16, &quot;Error code.&quot;),</span>
                                                                       new Field(&quot;partitions&quot;,
                                                                                 new ArrayOf(LEADER_AND_ISR_RESPONSE_PARTITION_V0)));

<span class="nc" id="L754">    public static final Schema[] LEADER_AND_ISR_REQUEST = new Schema[] {LEADER_AND_ISR_REQUEST_V0};</span>
<span class="nc" id="L755">    public static final Schema[] LEADER_AND_ISR_RESPONSE = new Schema[] {LEADER_AND_ISR_RESPONSE_V0};</span>

    /* Replica api */
<span class="nc" id="L758">    public static final Schema STOP_REPLICA_REQUEST_PARTITION_V0 = new Schema(new Field(&quot;topic&quot;, STRING, &quot;Topic name.&quot;),</span>
                                                                              new Field(&quot;partition&quot;, INT32, &quot;Topic partition id.&quot;));

<span class="nc" id="L761">    public static final Schema STOP_REPLICA_REQUEST_V0 = new Schema(new Field(&quot;controller_id&quot;, INT32, &quot;The controller id.&quot;),</span>
                                                                    new Field(&quot;controller_epoch&quot;, INT32, &quot;The controller epoch.&quot;),
                                                                    new Field(&quot;delete_partitions&quot;, BOOLEAN,
                                                                              &quot;Boolean which indicates if replica's partitions must be deleted.&quot;),
                                                                    new Field(&quot;partitions&quot;,
                                                                              new ArrayOf(STOP_REPLICA_REQUEST_PARTITION_V0)));

<span class="nc" id="L768">    public static final Schema STOP_REPLICA_RESPONSE_PARTITION_V0 = new Schema(new Field(&quot;topic&quot;, STRING, &quot;Topic name.&quot;),</span>
                                                                               new Field(&quot;partition&quot;, INT32, &quot;Topic partition id.&quot;),
                                                                               new Field(&quot;error_code&quot;, INT16, &quot;Error code.&quot;));

<span class="nc" id="L772">    public static final Schema STOP_REPLICA_RESPONSE_V0 = new Schema(new Field(&quot;error_code&quot;, INT16, &quot;Error code.&quot;),</span>
                                                                     new Field(&quot;partitions&quot;,
                                                                               new ArrayOf(STOP_REPLICA_RESPONSE_PARTITION_V0)));

<span class="nc" id="L776">    public static final Schema[] STOP_REPLICA_REQUEST = new Schema[] {STOP_REPLICA_REQUEST_V0};</span>
<span class="nc" id="L777">    public static final Schema[] STOP_REPLICA_RESPONSE = new Schema[] {STOP_REPLICA_RESPONSE_V0};</span>

    /* Update metadata api */

<span class="nc" id="L781">    public static final Schema UPDATE_METADATA_REQUEST_PARTITION_STATE_V0 = LEADER_AND_ISR_REQUEST_PARTITION_STATE_V0;</span>

<span class="nc" id="L783">    public static final Schema UPDATE_METADATA_REQUEST_BROKER_V0 =</span>
            new Schema(new Field(&quot;id&quot;, INT32, &quot;The broker id.&quot;),
                       new Field(&quot;host&quot;, STRING, &quot;The hostname of the broker.&quot;),
                       new Field(&quot;port&quot;, INT32, &quot;The port on which the broker accepts requests.&quot;));

<span class="nc" id="L788">    public static final Schema UPDATE_METADATA_REQUEST_V0 = new Schema(new Field(&quot;controller_id&quot;, INT32, &quot;The controller id.&quot;),</span>
                                                                       new Field(&quot;controller_epoch&quot;, INT32, &quot;The controller epoch.&quot;),
                                                                       new Field(&quot;partition_states&quot;,
                                                                                 new ArrayOf(UPDATE_METADATA_REQUEST_PARTITION_STATE_V0)),
                                                                       new Field(&quot;live_brokers&quot;,
                                                                                 new ArrayOf(UPDATE_METADATA_REQUEST_BROKER_V0)));

<span class="nc" id="L795">    public static final Schema UPDATE_METADATA_RESPONSE_V0 = new Schema(new Field(&quot;error_code&quot;, INT16, &quot;Error code.&quot;));</span>

<span class="nc" id="L797">    public static final Schema UPDATE_METADATA_REQUEST_PARTITION_STATE_V1 = UPDATE_METADATA_REQUEST_PARTITION_STATE_V0;</span>

<span class="nc" id="L799">    public static final Schema UPDATE_METADATA_REQUEST_END_POINT_V1 =</span>
            // for some reason, V1 sends `port` before `host` while V0 sends `host` before `port
            new Schema(new Field(&quot;port&quot;, INT32, &quot;The port on which the broker accepts requests.&quot;),
                       new Field(&quot;host&quot;, STRING, &quot;The hostname of the broker.&quot;),
                       new Field(&quot;security_protocol_type&quot;, INT16, &quot;The security protocol type.&quot;));

<span class="nc" id="L805">    public static final Schema UPDATE_METADATA_REQUEST_BROKER_V1 =</span>
            new Schema(new Field(&quot;id&quot;, INT32, &quot;The broker id.&quot;),
                       new Field(&quot;end_points&quot;, new ArrayOf(UPDATE_METADATA_REQUEST_END_POINT_V1)));

<span class="nc" id="L809">    public static final Schema UPDATE_METADATA_REQUEST_V1 = new Schema(new Field(&quot;controller_id&quot;, INT32, &quot;The controller id.&quot;),</span>
                                                                       new Field(&quot;controller_epoch&quot;, INT32, &quot;The controller epoch.&quot;),
                                                                       new Field(&quot;partition_states&quot;,
                                                                                 new ArrayOf(UPDATE_METADATA_REQUEST_PARTITION_STATE_V1)),
                                                                       new Field(&quot;live_brokers&quot;,
                                                                                 new ArrayOf(UPDATE_METADATA_REQUEST_BROKER_V1)));

<span class="nc" id="L816">    public static final Schema UPDATE_METADATA_RESPONSE_V1 = UPDATE_METADATA_RESPONSE_V0;</span>

<span class="nc" id="L818">    public static final Schema UPDATE_METADATA_REQUEST_PARTITION_STATE_V2 = UPDATE_METADATA_REQUEST_PARTITION_STATE_V1;</span>

<span class="nc" id="L820">    public static final Schema UPDATE_METADATA_REQUEST_END_POINT_V2 = UPDATE_METADATA_REQUEST_END_POINT_V1;</span>

<span class="nc" id="L822">    public static final Schema UPDATE_METADATA_REQUEST_BROKER_V2 =</span>
                    new Schema(new Field(&quot;id&quot;, INT32, &quot;The broker id.&quot;),
                               new Field(&quot;end_points&quot;, new ArrayOf(UPDATE_METADATA_REQUEST_END_POINT_V2)),
                               new Field(&quot;rack&quot;, NULLABLE_STRING, &quot;The rack&quot;));

<span class="nc" id="L827">    public static final Schema UPDATE_METADATA_REQUEST_V2 =</span>
            new Schema(new Field(&quot;controller_id&quot;, INT32, &quot;The controller id.&quot;),
                       new Field(&quot;controller_epoch&quot;, INT32, &quot;The controller epoch.&quot;),
                       new Field(&quot;partition_states&quot;, new ArrayOf(UPDATE_METADATA_REQUEST_PARTITION_STATE_V2)),
                       new Field(&quot;live_brokers&quot;, new ArrayOf(UPDATE_METADATA_REQUEST_BROKER_V2)));

<span class="nc" id="L833">    public static final Schema UPDATE_METADATA_RESPONSE_V2 = UPDATE_METADATA_RESPONSE_V1;</span>


<span class="nc" id="L836">    public static final Schema[] UPDATE_METADATA_REQUEST = new Schema[] {UPDATE_METADATA_REQUEST_V0, UPDATE_METADATA_REQUEST_V1, UPDATE_METADATA_REQUEST_V2};</span>
<span class="nc" id="L837">    public static final Schema[] UPDATE_METADATA_RESPONSE = new Schema[] {UPDATE_METADATA_RESPONSE_V0, UPDATE_METADATA_RESPONSE_V1, UPDATE_METADATA_RESPONSE_V2};</span>

    /* SASL handshake api */
<span class="nc" id="L840">    public static final Schema SASL_HANDSHAKE_REQUEST_V0 = new Schema(</span>
            new Field(&quot;mechanism&quot;, STRING, &quot;SASL Mechanism chosen by the client.&quot;));

<span class="nc" id="L843">    public static final Schema SASL_HANDSHAKE_RESPONSE_V0 = new Schema(</span>
            new Field(&quot;error_code&quot;, INT16),
            new Field(&quot;enabled_mechanisms&quot;, new ArrayOf(Type.STRING), &quot;Array of mechanisms enabled in the server.&quot;));

<span class="nc" id="L847">    public static final Schema[] SASL_HANDSHAKE_REQUEST = new Schema[] {SASL_HANDSHAKE_REQUEST_V0};</span>
<span class="nc" id="L848">    public static final Schema[] SASL_HANDSHAKE_RESPONSE = new Schema[] {SASL_HANDSHAKE_RESPONSE_V0};</span>

    /* ApiVersion api */
<span class="nc" id="L851">    public static final Schema API_VERSIONS_REQUEST_V0 = new Schema();</span>

<span class="nc" id="L853">    public static final Schema API_VERSIONS_V0 = new Schema(new Field(&quot;api_key&quot;, INT16, &quot;API key.&quot;),</span>
                                                           new Field(&quot;min_version&quot;, INT16, &quot;Minimum supported version.&quot;),
                                                           new Field(&quot;max_version&quot;, INT16, &quot;Maximum supported version.&quot;));

<span class="nc" id="L857">    public static final Schema API_VERSIONS_RESPONSE_V0 = new Schema(new Field(&quot;error_code&quot;, INT16, &quot;Error code.&quot;),</span>
                                                                    new Field(&quot;api_versions&quot;, new ArrayOf(API_VERSIONS_V0), &quot;API versions supported by the broker.&quot;));

<span class="nc" id="L860">    public static final Schema[] API_VERSIONS_REQUEST = new Schema[]{API_VERSIONS_REQUEST_V0};</span>
<span class="nc" id="L861">    public static final Schema[] API_VERSIONS_RESPONSE = new Schema[]{API_VERSIONS_RESPONSE_V0};</span>

    /* Admin requests common */
<span class="nc" id="L864">    public static final Schema CONFIG_ENTRY = new Schema(new Field(&quot;config_key&quot;, STRING, &quot;Configuration key name&quot;),</span>
        new Field(&quot;config_value&quot;, STRING, &quot;Configuration value&quot;));

<span class="nc" id="L867">    public static final Schema PARTITION_REPLICA_ASSIGNMENT_ENTRY = new Schema(</span>
        new Field(&quot;partition_id&quot;, INT32),
        new Field(&quot;replicas&quot;, new ArrayOf(INT32), &quot;The set of all nodes that should host this partition. The first replica in the list is the preferred leader.&quot;));

<span class="nc" id="L871">    public static final Schema TOPIC_ERROR_CODE = new Schema(new Field(&quot;topic&quot;, STRING), new Field(&quot;error_code&quot;, INT16));</span>

    /* CreateTopic api */
<span class="nc" id="L874">    public static final Schema SINGLE_CREATE_TOPIC_REQUEST_V0 = new Schema(</span>
        new Field(&quot;topic&quot;,
            STRING,
            &quot;Name for newly created topic.&quot;),
        new Field(&quot;num_partitions&quot;,
            INT32,
            &quot;Number of partitions to be created. -1 indicates unset.&quot;),
        new Field(&quot;replication_factor&quot;,
            INT16,
            &quot;Replication factor for the topic. -1 indicates unset.&quot;),
        new Field(&quot;replica_assignment&quot;,
            new ArrayOf(PARTITION_REPLICA_ASSIGNMENT_ENTRY),
            &quot;Replica assignment among kafka brokers for this topic partitions. If this is set num_partitions and replication_factor must be unset.&quot;),
        new Field(&quot;configs&quot;,
            new ArrayOf(CONFIG_ENTRY),
            &quot;Topic level configuration for topic to be set.&quot;));

<span class="nc" id="L891">    public static final Schema CREATE_TOPICS_REQUEST_V0 = new Schema(</span>
        new Field(&quot;create_topic_requests&quot;,
            new ArrayOf(SINGLE_CREATE_TOPIC_REQUEST_V0),
            &quot;An array of single topic creation requests. Can not have multiple entries for the same topic.&quot;),
        new Field(&quot;timeout&quot;,
            INT32,
            &quot;The time in ms to wait for a topic to be completely created on the controller node. Values &lt;= 0 will trigger topic creation and return immediately&quot;));

<span class="nc" id="L899">    public static final Schema CREATE_TOPICS_RESPONSE_V0 = new Schema(</span>
        new Field(&quot;topic_error_codes&quot;,
            new ArrayOf(TOPIC_ERROR_CODE),
            &quot;An array of per topic error codes.&quot;));

<span class="nc" id="L904">    public static final Schema[] CREATE_TOPICS_REQUEST = new Schema[] {CREATE_TOPICS_REQUEST_V0};</span>
<span class="nc" id="L905">    public static final Schema[] CREATE_TOPICS_RESPONSE = new Schema[] {CREATE_TOPICS_RESPONSE_V0};</span>

    /* DeleteTopic api */
<span class="nc" id="L908">    public static final Schema DELETE_TOPICS_REQUEST_V0 = new Schema(</span>
        new Field(&quot;topics&quot;,
            new ArrayOf(STRING),
            &quot;An array of topics to be deleted.&quot;),
        new Field(&quot;timeout&quot;,
            INT32,
            &quot;The time in ms to wait for a topic to be completely deleted on the controller node. Values &lt;= 0 will trigger topic deletion and return immediately&quot;));

<span class="nc" id="L916">    public static final Schema DELETE_TOPICS_RESPONSE_V0 = new Schema(</span>
        new Field(&quot;topic_error_codes&quot;,
            new ArrayOf(TOPIC_ERROR_CODE),
            &quot;An array of per topic error codes.&quot;));

<span class="nc" id="L921">    public static final Schema[] DELETE_TOPICS_REQUEST = new Schema[] {DELETE_TOPICS_REQUEST_V0};</span>
<span class="nc" id="L922">    public static final Schema[] DELETE_TOPICS_RESPONSE = new Schema[] {DELETE_TOPICS_RESPONSE_V0};</span>

    /* an array of all requests and responses with all schema versions; a null value in the inner array means that the
     * particular version is not supported */
<span class="nc" id="L926">    public static final Schema[][] REQUESTS = new Schema[ApiKeys.MAX_API_KEY + 1][];</span>
<span class="nc" id="L927">    public static final Schema[][] RESPONSES = new Schema[ApiKeys.MAX_API_KEY + 1][];</span>
<span class="nc" id="L928">    public static final short[] MIN_VERSIONS = new short[ApiKeys.MAX_API_KEY + 1];</span>

    /* the latest version of each api */
<span class="nc" id="L931">    public static final short[] CURR_VERSION = new short[ApiKeys.MAX_API_KEY + 1];</span>

    static {
<span class="nc" id="L934">        REQUESTS[ApiKeys.PRODUCE.id] = PRODUCE_REQUEST;</span>
<span class="nc" id="L935">        REQUESTS[ApiKeys.FETCH.id] = FETCH_REQUEST;</span>
<span class="nc" id="L936">        REQUESTS[ApiKeys.LIST_OFFSETS.id] = LIST_OFFSET_REQUEST;</span>
<span class="nc" id="L937">        REQUESTS[ApiKeys.METADATA.id] = METADATA_REQUEST;</span>
<span class="nc" id="L938">        REQUESTS[ApiKeys.LEADER_AND_ISR.id] = LEADER_AND_ISR_REQUEST;</span>
<span class="nc" id="L939">        REQUESTS[ApiKeys.STOP_REPLICA.id] = STOP_REPLICA_REQUEST;</span>
<span class="nc" id="L940">        REQUESTS[ApiKeys.UPDATE_METADATA_KEY.id] = UPDATE_METADATA_REQUEST;</span>
<span class="nc" id="L941">        REQUESTS[ApiKeys.CONTROLLED_SHUTDOWN_KEY.id] = CONTROLLED_SHUTDOWN_REQUEST;</span>
<span class="nc" id="L942">        REQUESTS[ApiKeys.OFFSET_COMMIT.id] = OFFSET_COMMIT_REQUEST;</span>
<span class="nc" id="L943">        REQUESTS[ApiKeys.OFFSET_FETCH.id] = OFFSET_FETCH_REQUEST;</span>
<span class="nc" id="L944">        REQUESTS[ApiKeys.GROUP_COORDINATOR.id] = GROUP_COORDINATOR_REQUEST;</span>
<span class="nc" id="L945">        REQUESTS[ApiKeys.JOIN_GROUP.id] = JOIN_GROUP_REQUEST;</span>
<span class="nc" id="L946">        REQUESTS[ApiKeys.HEARTBEAT.id] = HEARTBEAT_REQUEST;</span>
<span class="nc" id="L947">        REQUESTS[ApiKeys.LEAVE_GROUP.id] = LEAVE_GROUP_REQUEST;</span>
<span class="nc" id="L948">        REQUESTS[ApiKeys.SYNC_GROUP.id] = SYNC_GROUP_REQUEST;</span>
<span class="nc" id="L949">        REQUESTS[ApiKeys.DESCRIBE_GROUPS.id] = DESCRIBE_GROUPS_REQUEST;</span>
<span class="nc" id="L950">        REQUESTS[ApiKeys.LIST_GROUPS.id] = LIST_GROUPS_REQUEST;</span>
<span class="nc" id="L951">        REQUESTS[ApiKeys.SASL_HANDSHAKE.id] = SASL_HANDSHAKE_REQUEST;</span>
<span class="nc" id="L952">        REQUESTS[ApiKeys.API_VERSIONS.id] = API_VERSIONS_REQUEST;</span>
<span class="nc" id="L953">        REQUESTS[ApiKeys.CREATE_TOPICS.id] = CREATE_TOPICS_REQUEST;</span>
<span class="nc" id="L954">        REQUESTS[ApiKeys.DELETE_TOPICS.id] = DELETE_TOPICS_REQUEST;</span>

<span class="nc" id="L956">        RESPONSES[ApiKeys.PRODUCE.id] = PRODUCE_RESPONSE;</span>
<span class="nc" id="L957">        RESPONSES[ApiKeys.FETCH.id] = FETCH_RESPONSE;</span>
<span class="nc" id="L958">        RESPONSES[ApiKeys.LIST_OFFSETS.id] = LIST_OFFSET_RESPONSE;</span>
<span class="nc" id="L959">        RESPONSES[ApiKeys.METADATA.id] = METADATA_RESPONSE;</span>
<span class="nc" id="L960">        RESPONSES[ApiKeys.LEADER_AND_ISR.id] = LEADER_AND_ISR_RESPONSE;</span>
<span class="nc" id="L961">        RESPONSES[ApiKeys.STOP_REPLICA.id] = STOP_REPLICA_RESPONSE;</span>
<span class="nc" id="L962">        RESPONSES[ApiKeys.UPDATE_METADATA_KEY.id] = UPDATE_METADATA_RESPONSE;</span>
<span class="nc" id="L963">        RESPONSES[ApiKeys.CONTROLLED_SHUTDOWN_KEY.id] = CONTROLLED_SHUTDOWN_RESPONSE;</span>
<span class="nc" id="L964">        RESPONSES[ApiKeys.OFFSET_COMMIT.id] = OFFSET_COMMIT_RESPONSE;</span>
<span class="nc" id="L965">        RESPONSES[ApiKeys.OFFSET_FETCH.id] = OFFSET_FETCH_RESPONSE;</span>
<span class="nc" id="L966">        RESPONSES[ApiKeys.GROUP_COORDINATOR.id] = GROUP_COORDINATOR_RESPONSE;</span>
<span class="nc" id="L967">        RESPONSES[ApiKeys.JOIN_GROUP.id] = JOIN_GROUP_RESPONSE;</span>
<span class="nc" id="L968">        RESPONSES[ApiKeys.HEARTBEAT.id] = HEARTBEAT_RESPONSE;</span>
<span class="nc" id="L969">        RESPONSES[ApiKeys.LEAVE_GROUP.id] = LEAVE_GROUP_RESPONSE;</span>
<span class="nc" id="L970">        RESPONSES[ApiKeys.SYNC_GROUP.id] = SYNC_GROUP_RESPONSE;</span>
<span class="nc" id="L971">        RESPONSES[ApiKeys.DESCRIBE_GROUPS.id] = DESCRIBE_GROUPS_RESPONSE;</span>
<span class="nc" id="L972">        RESPONSES[ApiKeys.LIST_GROUPS.id] = LIST_GROUPS_RESPONSE;</span>
<span class="nc" id="L973">        RESPONSES[ApiKeys.SASL_HANDSHAKE.id] = SASL_HANDSHAKE_RESPONSE;</span>
<span class="nc" id="L974">        RESPONSES[ApiKeys.API_VERSIONS.id] = API_VERSIONS_RESPONSE;</span>
<span class="nc" id="L975">        RESPONSES[ApiKeys.CREATE_TOPICS.id] = CREATE_TOPICS_RESPONSE;</span>
<span class="nc" id="L976">        RESPONSES[ApiKeys.DELETE_TOPICS.id] = DELETE_TOPICS_RESPONSE;</span>

        /* set the minimum and maximum version of each api */
<span class="nc bnc" id="L979" title="All 2 branches missed.">        for (ApiKeys api : ApiKeys.values()) {</span>
<span class="nc" id="L980">            CURR_VERSION[api.id] = (short) (REQUESTS[api.id].length - 1);</span>
<span class="nc bnc" id="L981" title="All 2 branches missed.">            for (int i = 0; i &lt; REQUESTS[api.id].length; ++i)</span>
<span class="nc bnc" id="L982" title="All 2 branches missed.">                if (REQUESTS[api.id][i] != null) {</span>
<span class="nc" id="L983">                    MIN_VERSIONS[api.id] = (short) i;</span>
<span class="nc" id="L984">                    break;</span>
                }
        }

        /* sanity check that:
         *   - we have the same number of request and response versions for each api
         *   - we have a consistent set of request and response versions for each api */
<span class="nc bnc" id="L991" title="All 2 branches missed.">        for (ApiKeys api : ApiKeys.values()) {</span>
<span class="nc bnc" id="L992" title="All 2 branches missed.">            if (REQUESTS[api.id].length != RESPONSES[api.id].length)</span>
<span class="nc" id="L993">                throw new IllegalStateException(REQUESTS[api.id].length + &quot; request versions for api &quot; + api.name</span>
                        + &quot; but &quot; + RESPONSES[api.id].length + &quot; response versions.&quot;);

<span class="nc bnc" id="L996" title="All 2 branches missed.">            for (int i = 0; i &lt; REQUESTS[api.id].length; ++i)</span>
<span class="nc bnc" id="L997" title="All 8 branches missed.">                if ((REQUESTS[api.id][i] == null &amp;&amp; RESPONSES[api.id][i] != null) ||</span>
                        (REQUESTS[api.id][i] != null &amp;&amp; RESPONSES[api.id][i] == null))
<span class="nc" id="L999">                    throw new IllegalStateException(&quot;Request and response for version &quot; + i + &quot; of API &quot;</span>
                            + api.id + &quot; are defined inconsistently. One is null while the other is not null.&quot;);
        }
<span class="nc" id="L1002">    }</span>

    public static boolean apiVersionSupported(short apiKey, short apiVersion) {
<span class="nc bnc" id="L1005" title="All 6 branches missed.">        return apiKey &lt; CURR_VERSION.length &amp;&amp; apiVersion &gt;= MIN_VERSIONS[apiKey] &amp;&amp; apiVersion &lt;= CURR_VERSION[apiKey];</span>
    }

    private static String indentString(int size) {
<span class="nc" id="L1009">        StringBuilder b = new StringBuilder(size);</span>
<span class="nc bnc" id="L1010" title="All 2 branches missed.">        for (int i = 0; i &lt; size; i++)</span>
<span class="nc" id="L1011">            b.append(&quot; &quot;);</span>
<span class="nc" id="L1012">        return b.toString();</span>
    }

    private static void schemaToBnfHtml(Schema schema, StringBuilder b, int indentSize) {
<span class="nc" id="L1016">        final String indentStr = indentString(indentSize);</span>
<span class="nc" id="L1017">        final Map&lt;String, Type&gt; subTypes = new LinkedHashMap&lt;&gt;();</span>

        // Top level fields
<span class="nc bnc" id="L1020" title="All 2 branches missed.">        for (Field field: schema.fields()) {</span>
<span class="nc bnc" id="L1021" title="All 2 branches missed.">            if (field.type instanceof ArrayOf) {</span>
<span class="nc" id="L1022">                b.append(&quot;[&quot;);</span>
<span class="nc" id="L1023">                b.append(field.name);</span>
<span class="nc" id="L1024">                b.append(&quot;] &quot;);</span>
<span class="nc" id="L1025">                Type innerType = ((ArrayOf) field.type).type();</span>
<span class="nc bnc" id="L1026" title="All 2 branches missed.">                if (!subTypes.containsKey(field.name))</span>
<span class="nc" id="L1027">                    subTypes.put(field.name, innerType);</span>
<span class="nc bnc" id="L1028" title="All 2 branches missed.">            } else if (field.type instanceof Schema) {</span>
<span class="nc" id="L1029">                b.append(field.name);</span>
<span class="nc" id="L1030">                b.append(&quot; &quot;);</span>
<span class="nc bnc" id="L1031" title="All 2 branches missed.">                if (!subTypes.containsKey(field.name))</span>
<span class="nc" id="L1032">                    subTypes.put(field.name, field.type);</span>
            } else {
<span class="nc" id="L1034">                b.append(field.name);</span>
<span class="nc" id="L1035">                b.append(&quot; &quot;);</span>
<span class="nc bnc" id="L1036" title="All 2 branches missed.">                if (!subTypes.containsKey(field.name))</span>
<span class="nc" id="L1037">                    subTypes.put(field.name, field.type);</span>
            }
        }
<span class="nc" id="L1040">        b.append(&quot;\n&quot;);</span>

        // Sub Types/Schemas
<span class="nc bnc" id="L1043" title="All 2 branches missed.">        for (Map.Entry&lt;String, Type&gt; entry: subTypes.entrySet()) {</span>
<span class="nc bnc" id="L1044" title="All 2 branches missed.">            if (entry.getValue() instanceof Schema) {</span>
                // Complex Schema Type
<span class="nc" id="L1046">                b.append(indentStr);</span>
<span class="nc" id="L1047">                b.append(entry.getKey());</span>
<span class="nc" id="L1048">                b.append(&quot; =&gt; &quot;);</span>
<span class="nc" id="L1049">                schemaToBnfHtml((Schema) entry.getValue(), b, indentSize + 2);</span>
            } else {
                // Standard Field Type
<span class="nc" id="L1052">                b.append(indentStr);</span>
<span class="nc" id="L1053">                b.append(entry.getKey());</span>
<span class="nc" id="L1054">                b.append(&quot; =&gt; &quot;);</span>
<span class="nc" id="L1055">                b.append(entry.getValue());</span>
<span class="nc" id="L1056">                b.append(&quot;\n&quot;);</span>
            }
<span class="nc" id="L1058">        }</span>
<span class="nc" id="L1059">    }</span>

    private static void populateSchemaFields(Schema schema, Set&lt;Field&gt; fields) {
<span class="nc bnc" id="L1062" title="All 2 branches missed.">        for (Field field: schema.fields()) {</span>
<span class="nc" id="L1063">            fields.add(field);</span>
<span class="nc bnc" id="L1064" title="All 2 branches missed.">            if (field.type instanceof ArrayOf) {</span>
<span class="nc" id="L1065">                Type innerType = ((ArrayOf) field.type).type();</span>
<span class="nc bnc" id="L1066" title="All 2 branches missed.">                if (innerType instanceof Schema)</span>
<span class="nc" id="L1067">                    populateSchemaFields((Schema) innerType, fields);</span>
<span class="nc bnc" id="L1068" title="All 2 branches missed.">            } else if (field.type instanceof Schema)</span>
<span class="nc" id="L1069">                populateSchemaFields((Schema) field.type, fields);</span>
        }
<span class="nc" id="L1071">    }</span>

    private static void schemaToFieldTableHtml(Schema schema, StringBuilder b) {
<span class="nc" id="L1074">        Set&lt;Field&gt; fields = new LinkedHashSet&lt;&gt;();</span>
<span class="nc" id="L1075">        populateSchemaFields(schema, fields);</span>

<span class="nc" id="L1077">        b.append(&quot;&lt;table class=\&quot;data-table\&quot;&gt;&lt;tbody&gt;\n&quot;);</span>
<span class="nc" id="L1078">        b.append(&quot;&lt;tr&gt;&quot;);</span>
<span class="nc" id="L1079">        b.append(&quot;&lt;th&gt;Field&lt;/th&gt;\n&quot;);</span>
<span class="nc" id="L1080">        b.append(&quot;&lt;th&gt;Description&lt;/th&gt;\n&quot;);</span>
<span class="nc" id="L1081">        b.append(&quot;&lt;/tr&gt;&quot;);</span>
<span class="nc bnc" id="L1082" title="All 2 branches missed.">        for (Field field : fields) {</span>
<span class="nc" id="L1083">            b.append(&quot;&lt;tr&gt;\n&quot;);</span>
<span class="nc" id="L1084">            b.append(&quot;&lt;td&gt;&quot;);</span>
<span class="nc" id="L1085">            b.append(field.name);</span>
<span class="nc" id="L1086">            b.append(&quot;&lt;/td&gt;&quot;);</span>
<span class="nc" id="L1087">            b.append(&quot;&lt;td&gt;&quot;);</span>
<span class="nc" id="L1088">            b.append(field.doc);</span>
<span class="nc" id="L1089">            b.append(&quot;&lt;/td&gt;&quot;);</span>
<span class="nc" id="L1090">            b.append(&quot;&lt;/tr&gt;\n&quot;);</span>
<span class="nc" id="L1091">        }</span>
<span class="nc" id="L1092">        b.append(&quot;&lt;/table&gt;\n&quot;);</span>
<span class="nc" id="L1093">    }</span>

    public static String toHtml() {
<span class="nc" id="L1096">        final StringBuilder b = new StringBuilder();</span>
<span class="nc" id="L1097">        b.append(&quot;&lt;h5&gt;Headers:&lt;/h5&gt;\n&quot;);</span>

<span class="nc" id="L1099">        b.append(&quot;&lt;pre&gt;&quot;);</span>
<span class="nc" id="L1100">        b.append(&quot;Request Header =&gt; &quot;);</span>
<span class="nc" id="L1101">        schemaToBnfHtml(REQUEST_HEADER, b, 2);</span>
<span class="nc" id="L1102">        b.append(&quot;&lt;/pre&gt;\n&quot;);</span>
<span class="nc" id="L1103">        schemaToFieldTableHtml(REQUEST_HEADER, b);</span>

<span class="nc" id="L1105">        b.append(&quot;&lt;pre&gt;&quot;);</span>
<span class="nc" id="L1106">        b.append(&quot;Response Header =&gt; &quot;);</span>
<span class="nc" id="L1107">        schemaToBnfHtml(RESPONSE_HEADER, b, 2);</span>
<span class="nc" id="L1108">        b.append(&quot;&lt;/pre&gt;\n&quot;);</span>
<span class="nc" id="L1109">        schemaToFieldTableHtml(RESPONSE_HEADER, b);</span>

<span class="nc bnc" id="L1111" title="All 2 branches missed.">        for (ApiKeys key : ApiKeys.values()) {</span>
            // Key
<span class="nc" id="L1113">            b.append(&quot;&lt;h5&gt;&quot;);</span>
<span class="nc" id="L1114">            b.append(key.name);</span>
<span class="nc" id="L1115">            b.append(&quot; API (Key: &quot;);</span>
<span class="nc" id="L1116">            b.append(key.id);</span>
<span class="nc" id="L1117">            b.append(&quot;):&lt;/h5&gt;\n\n&quot;);</span>
            // Requests
<span class="nc" id="L1119">            b.append(&quot;&lt;b&gt;Requests:&lt;/b&gt;&lt;br&gt;\n&quot;);</span>
<span class="nc" id="L1120">            Schema[] requests = REQUESTS[key.id];</span>
<span class="nc bnc" id="L1121" title="All 2 branches missed.">            for (int i = 0; i &lt; requests.length; i++) {</span>
<span class="nc" id="L1122">                Schema schema = requests[i];</span>
                // Schema
<span class="nc bnc" id="L1124" title="All 2 branches missed.">                if (schema != null) {</span>
<span class="nc" id="L1125">                    b.append(&quot;&lt;p&gt;&quot;);</span>
                    // Version header
<span class="nc" id="L1127">                    b.append(&quot;&lt;pre&gt;&quot;);</span>
<span class="nc" id="L1128">                    b.append(key.name);</span>
<span class="nc" id="L1129">                    b.append(&quot; Request (Version: &quot;);</span>
<span class="nc" id="L1130">                    b.append(i);</span>
<span class="nc" id="L1131">                    b.append(&quot;) =&gt; &quot;);</span>
<span class="nc" id="L1132">                    schemaToBnfHtml(requests[i], b, 2);</span>
<span class="nc" id="L1133">                    b.append(&quot;&lt;/pre&gt;&quot;);</span>
<span class="nc" id="L1134">                    schemaToFieldTableHtml(requests[i], b);</span>
                }
<span class="nc" id="L1136">                b.append(&quot;&lt;/p&gt;\n&quot;);</span>
            }

            // Responses
<span class="nc" id="L1140">            b.append(&quot;&lt;b&gt;Responses:&lt;/b&gt;&lt;br&gt;\n&quot;);</span>
<span class="nc" id="L1141">            Schema[] responses = RESPONSES[key.id];</span>
<span class="nc bnc" id="L1142" title="All 2 branches missed.">            for (int i = 0; i &lt; responses.length; i++) {</span>
<span class="nc" id="L1143">                Schema schema = responses[i];</span>
                // Schema
<span class="nc bnc" id="L1145" title="All 2 branches missed.">                if (schema != null) {</span>
<span class="nc" id="L1146">                    b.append(&quot;&lt;p&gt;&quot;);</span>
                    // Version header
<span class="nc" id="L1148">                    b.append(&quot;&lt;pre&gt;&quot;);</span>
<span class="nc" id="L1149">                    b.append(key.name);</span>
<span class="nc" id="L1150">                    b.append(&quot; Response (Version: &quot;);</span>
<span class="nc" id="L1151">                    b.append(i);</span>
<span class="nc" id="L1152">                    b.append(&quot;) =&gt; &quot;);</span>
<span class="nc" id="L1153">                    schemaToBnfHtml(responses[i], b, 2);</span>
<span class="nc" id="L1154">                    b.append(&quot;&lt;/pre&gt;&quot;);</span>
<span class="nc" id="L1155">                    schemaToFieldTableHtml(responses[i], b);</span>
                }
<span class="nc" id="L1157">                b.append(&quot;&lt;/p&gt;\n&quot;);</span>
            }
        }

<span class="nc" id="L1161">        return b.toString();</span>
    }

    public static void main(String[] args) {
<span class="nc" id="L1165">        System.out.println(toHtml());</span>
<span class="nc" id="L1166">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>